"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@identity-connect+crypto@0.2.4_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0";
exports.ids = ["vendor-chunks/@identity-connect+crypto@0.2.4_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@identity-connect+crypto@0.2.4_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@identity-connect/crypto/dist/index.mjs":
/*!*****************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@identity-connect+crypto@0.2.4_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@identity-connect/crypto/dist/index.mjs ***!
  \*****************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccountConnectionAction: () => (/* binding */ AccountConnectionAction),\n/* harmony export */   DecryptionError: () => (/* binding */ DecryptionError),\n/* harmony export */   EncryptionEnvelopeError: () => (/* binding */ EncryptionEnvelopeError),\n/* harmony export */   EnvelopeMessageMismatchError: () => (/* binding */ EnvelopeMessageMismatchError),\n/* harmony export */   KeyTypes: () => (/* binding */ KeyTypes),\n/* harmony export */   REQUIRED_FIELDS: () => (/* binding */ REQUIRED_FIELDS),\n/* harmony export */   SIGNATURE_PREFIX: () => (/* binding */ SIGNATURE_PREFIX),\n/* harmony export */   aptosAccountToEd25519Keypair: () => (/* binding */ aptosAccountToEd25519Keypair),\n/* harmony export */   aptosAccountToSerializedInfo: () => (/* binding */ aptosAccountToSerializedInfo),\n/* harmony export */   concatUint8array: () => (/* binding */ concatUint8array),\n/* harmony export */   constructMetadata: () => (/* binding */ constructMetadata),\n/* harmony export */   convertEd25519PublicKeyToX25519PublicKey: () => (/* binding */ convertEd25519PublicKeyToX25519PublicKey),\n/* harmony export */   convertEd25519SecretKeyToX25519SecretKey: () => (/* binding */ convertEd25519SecretKeyToX25519SecretKey),\n/* harmony export */   createEd25519KeyPair: () => (/* binding */ createEd25519KeyPair),\n/* harmony export */   createSerializedAccountInfo: () => (/* binding */ createSerializedAccountInfo),\n/* harmony export */   createX25519KeyPair: () => (/* binding */ createX25519KeyPair),\n/* harmony export */   dangerouslyEncryptAndSignEnvelopeUnvalidated: () => (/* binding */ dangerouslyEncryptAndSignEnvelopeUnvalidated),\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   decryptEnvelope: () => (/* binding */ decryptEnvelope),\n/* harmony export */   decryptMessage: () => (/* binding */ decryptMessage),\n/* harmony export */   decryptMessageDirect: () => (/* binding */ decryptMessageDirect),\n/* harmony export */   decryptObject: () => (/* binding */ decryptObject),\n/* harmony export */   decryptObjectDirect: () => (/* binding */ decryptObjectDirect),\n/* harmony export */   decryptSerializedEncryptionResult: () => (/* binding */ decryptSerializedEncryptionResult),\n/* harmony export */   decryptSerializedEncryptionResultDirect: () => (/* binding */ decryptSerializedEncryptionResultDirect),\n/* harmony export */   deriveAccountTransportEd25519Keypair: () => (/* binding */ deriveAccountTransportEd25519Keypair),\n/* harmony export */   deserializeEd25519PublicKeyB64: () => (/* binding */ deserializeEd25519PublicKeyB64),\n/* harmony export */   deserializeEd25519SignatureB64: () => (/* binding */ deserializeEd25519SignatureB64),\n/* harmony export */   deserializeEncryptionResult: () => (/* binding */ deserializeEncryptionResult),\n/* harmony export */   deserializePublicKeyB64: () => (/* binding */ deserializePublicKeyB64),\n/* harmony export */   deserializeSignatureB64: () => (/* binding */ deserializeSignatureB64),\n/* harmony export */   deserializeTransportEnvelope: () => (/* binding */ deserializeTransportEnvelope),\n/* harmony export */   ed25519KeypairFromSecret: () => (/* binding */ ed25519KeypairFromSecret),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64),\n/* harmony export */   encryptAndSignEnvelope: () => (/* binding */ encryptAndSignEnvelope),\n/* harmony export */   encryptMessage: () => (/* binding */ encryptMessage),\n/* harmony export */   encryptMessageDirect: () => (/* binding */ encryptMessageDirect),\n/* harmony export */   encryptObject: () => (/* binding */ encryptObject),\n/* harmony export */   encryptObjectDirect: () => (/* binding */ encryptObjectDirect),\n/* harmony export */   ensureMetadataFields: () => (/* binding */ ensureMetadataFields),\n/* harmony export */   ensurePrivatePublicFieldsDisjoint: () => (/* binding */ ensurePrivatePublicFieldsDisjoint),\n/* harmony export */   hashAndVerifySignature: () => (/* binding */ hashAndVerifySignature),\n/* harmony export */   keypairToEd25519: () => (/* binding */ keypairToEd25519),\n/* harmony export */   keypairToX25519: () => (/* binding */ keypairToX25519),\n/* harmony export */   makeEd25519SecretKeySignCallbackNoDomainSeparation: () => (/* binding */ makeEd25519SecretKeySignCallbackNoDomainSeparation),\n/* harmony export */   messageHash: () => (/* binding */ messageHash),\n/* harmony export */   publicKeyB64FromEd25519PublicKeyB64: () => (/* binding */ publicKeyB64FromEd25519PublicKeyB64),\n/* harmony export */   serializeEncryptionResult: () => (/* binding */ serializeEncryptionResult),\n/* harmony export */   serializePublicKeyB64: () => (/* binding */ serializePublicKeyB64),\n/* harmony export */   serializeSignatureB64: () => (/* binding */ serializeSignatureB64),\n/* harmony export */   signWithEd25519SecretKey: () => (/* binding */ signWithEd25519SecretKey),\n/* harmony export */   toKey: () => (/* binding */ toKey),\n/* harmony export */   verifyEnvelopeSignature: () => (/* binding */ verifyEnvelopeSignature),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/.pnpm/@aptos-labs+ts-sdk@1.30.0/node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @noble/hashes/sha3 */ \"(ssr)/./node_modules/.pnpm/@noble+hashes@1.6.1/node_modules/@noble/hashes/esm/sha3.js\");\n/* harmony import */ var tweetnacl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tweetnacl */ \"(ssr)/./node_modules/.pnpm/tweetnacl@1.0.3/node_modules/tweetnacl/nacl-fast.js\");\n/* harmony import */ var ed2curve__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ed2curve */ \"(ssr)/./node_modules/.pnpm/ed2curve@0.3.0/node_modules/ed2curve/ed2curve.js\");\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/.pnpm/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n// src/encrDecr.ts\n\n\n\n\n\n// src/errors.ts\nvar EncryptionEnvelopeError = class extends Error {\n};\nvar EnvelopeMessageMismatchError = class _EnvelopeMessageMismatchError extends EncryptionEnvelopeError {\n  constructor(message, field) {\n    super(message);\n    this.field = field;\n    this.name = \"EnvelopeMessageMismatchError\";\n    Object.setPrototypeOf(this, _EnvelopeMessageMismatchError.prototype);\n  }\n};\nvar DecryptionError = class _DecryptionError extends EncryptionEnvelopeError {\n  constructor(message) {\n    super(message);\n    this.name = \"DecryptionError\";\n    Object.setPrototypeOf(this, _DecryptionError.prototype);\n  }\n};\n\n// src/utils.ts\n\nvar KeyTypes = /* @__PURE__ */ ((KeyTypes2) => {\n  KeyTypes2[\"Ed25519PublicKey\"] = \"Ed25519PublicKey\";\n  KeyTypes2[\"Ed25519SecretKey\"] = \"Ed25519SecretKey\";\n  KeyTypes2[\"X25519PublicKey\"] = \"X25519PublicKey\";\n  KeyTypes2[\"X25519SecretKey\"] = \"X25519SecretKey\";\n  return KeyTypes2;\n})(KeyTypes || {});\nfunction createX25519KeyPair() {\n  return keypairToX25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.keyPair());\n}\nfunction createEd25519KeyPair() {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair());\n}\nfunction toKey(rawKey, type) {\n  return {\n    key: rawKey,\n    type\n  };\n}\nfunction keypairToEd25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"Ed25519PublicKey\" /* Ed25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"Ed25519SecretKey\" /* Ed25519SecretKey */)\n  };\n}\nfunction keypairToX25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"X25519PublicKey\" /* X25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"X25519SecretKey\" /* X25519SecretKey */)\n  };\n}\nfunction aptosAccountToEd25519Keypair(account) {\n  return ed25519KeypairFromSecret(account.signingKey.secretKey);\n}\nfunction ed25519KeypairFromSecret(ed25519SecretKeyBytes) {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair.fromSeed(ed25519SecretKeyBytes.slice(0, 32)));\n}\nfunction decodeBase64(base64Str) {\n  if (globalThis.Buffer) {\n    return new Uint8Array(Buffer.from(base64Str, \"base64\"));\n  }\n  return Uint8Array.from(atob(base64Str), (m) => m.codePointAt(0));\n}\nfunction encodeBase64(bytes) {\n  if (globalThis.Buffer) {\n    return Buffer.from(bytes).toString(\"base64\");\n  }\n  return btoa(Array.from(bytes, (x) => String.fromCodePoint(x)).join(\"\"));\n}\nfunction concatUint8array(arrayOne, arrayTwo) {\n  const mergedArray = new Uint8Array(arrayOne.length + arrayTwo.length);\n  mergedArray.set(arrayOne);\n  mergedArray.set(arrayTwo, arrayOne.length);\n  return mergedArray;\n}\n\n// src/encrDecr.ts\nvar SIGNATURE_PREFIX = \"APTOS::IDENTITY_CONNECT\";\nfunction convertEd25519PublicKeyToX25519PublicKey(ed25519PublicKey, errorKeyName) {\n  const x25519PublicKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertPublicKey(ed25519PublicKey.key.slice(0, 32));\n  if (!x25519PublicKey)\n    throw new Error(`${errorKeyName} is not a valid Ed25519 public key`);\n  return toKey(x25519PublicKey, \"X25519PublicKey\" /* X25519PublicKey */);\n}\nfunction convertEd25519SecretKeyToX25519SecretKey(ed25519SecretKey) {\n  const x25519SecretKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertSecretKey(ed25519SecretKey.key.slice(0, 32));\n  return toKey(x25519SecretKey, \"X25519SecretKey\" /* X25519SecretKey */);\n}\nfunction serializeEncryptionResult(enc) {\n  return {\n    nonceB64: encodeBase64(enc.nonce),\n    securedB64: encodeBase64(enc.secured)\n  };\n}\nfunction deserializeEncryptionResult(enc) {\n  return {\n    nonce: decodeBase64(enc.nonceB64),\n    secured: decodeBase64(enc.securedB64)\n  };\n}\nfunction decryptSerializedEncryptionResult(senderX25519PublicKey, receiverEd25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, des.secured, des.nonce);\n}\nfunction decryptSerializedEncryptionResultDirect(senderX25519PublicKey, receiverX25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, des.secured, des.nonce);\n}\nfunction encryptMessage(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  const nonce = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.randomBytes(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.nonceLength);\n  const messageUint8 = new TextEncoder().encode(message);\n  const secured = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box(messageUint8, nonce, receiverX25519PublicKey.key, senderX25519SecretKey.key.slice(0, 32));\n  return { nonce, secured };\n}\nfunction encryptObject(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, JSON.stringify(message));\n}\nfunction decryptMessage(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  let decryptedUint8;\n  try {\n    decryptedUint8 = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.open(\n      securedMessage,\n      nonce,\n      senderX25519PublicKey.key.slice(0, 32),\n      receiverX25519SecretKey.key.slice(0, 32)\n    );\n  } catch (e) {\n    throw new DecryptionError(`Could not decrypt message: ${e.message}`);\n  }\n  if (!decryptedUint8)\n    throw new DecryptionError(\"Could not decrypt message\");\n  return new TextDecoder().decode(decryptedUint8);\n}\nfunction decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  const decryptedStr = decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n  return JSON.parse(decryptedStr);\n}\nfunction messageHash(message, purpose) {\n  const signaturePrefixHash = new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(`${SIGNATURE_PREFIX}::${purpose}::`));\n  return new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(concatUint8array(signaturePrefixHash, message)));\n}\nfunction signWithEd25519SecretKey(message, signingEd25519SecretKey, purpose) {\n  return tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(messageHash(message, purpose), signingEd25519SecretKey.key);\n}\nfunction makeEd25519SecretKeySignCallbackNoDomainSeparation(signingEd25519SecretKey) {\n  return async (message) => new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(message, signingEd25519SecretKey.key));\n}\nfunction verifySignature(message, signature, signingPublicKey, purpose) {\n  return signingPublicKey.verifySignature({ message: messageHash(message, purpose), signature });\n}\nfunction hashAndVerifySignature(message, signature, signingPublicKey, purpose) {\n  const messageUint8 = message instanceof Uint8Array ? message : new TextEncoder().encode(message);\n  const messageUint8Hash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(messageUint8);\n  return verifySignature(messageUint8Hash, signature, signingPublicKey, purpose);\n}\n\n// src/securedEnvelope.ts\n\n\nvar REQUIRED_FIELDS = [\n  \"receiverEd25519PublicKeyB64\",\n  \"senderEd25519PublicKeyB64\",\n  \"senderX25519PublicKeyB64\",\n  \"sequence\",\n  \"timestampMillis\"\n].sort();\nfunction ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage) {\n  const intersection = Object.keys(privateMessage).filter((x) => Object.keys(publicMessage).includes(x));\n  if (intersection.length > 0) {\n    const field = intersection[0];\n    throw new EnvelopeMessageMismatchError(`Field ${field} appears in both private and public message fields`, field);\n  }\n}\nfunction ensureMetadataFields(message) {\n  const messageKeys = Object.keys(message).sort();\n  const extraFields = messageKeys.filter((key) => !REQUIRED_FIELDS.includes(key));\n  const missingFields = REQUIRED_FIELDS.filter((key) => !messageKeys.includes(key));\n  if (extraFields.length > 0 || missingFields.length > 0) {\n    let extraFieldsStr = extraFields.length > 0 ? `extra(${extraFields.join(\", \")})` : \"\";\n    const missingFieldsStr = missingFields.length > 0 ? `missing(${missingFields.join(\", \")})` : \"\";\n    extraFieldsStr = extraFieldsStr.length > 0 && missingFieldsStr.length > 0 ? `${extraFieldsStr}, ` : extraFieldsStr;\n    throw new EnvelopeMessageMismatchError(\n      `PublicMessage metadata fields do not conform to spec: ${extraFieldsStr}${missingFieldsStr}`,\n      \"_metadata\"\n    );\n  }\n}\nfunction deserializeTransportEnvelope(transportEnvelope) {\n  const publicMessage = JSON.parse(transportEnvelope.serializedPublicMessage);\n  return {\n    ...transportEnvelope,\n    publicMessage\n  };\n}\nfunction encryptAndSignEnvelope(senderEd25519SecretKey, senderEd25519PublicKey, receiverEd25519PublicKey, sequence, publicMessage, privateMessage) {\n  const senderEphemeralX25519KeyPair = createX25519KeyPair();\n  const metadata = constructMetadata(\n    senderEd25519PublicKey,\n    receiverEd25519PublicKey,\n    sequence,\n    senderEphemeralX25519KeyPair.publicKey\n  );\n  ensureMetadataFields(metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return dangerouslyEncryptAndSignEnvelopeUnvalidated(\n    senderEd25519SecretKey,\n    receiverEd25519PublicKey,\n    metadata,\n    privateMessage,\n    publicMessage,\n    senderEphemeralX25519KeyPair\n  );\n}\nfunction constructMetadata(senderEd25519PublicKey, receiverEd25519PublicKey, sequence, senderEphemeralX25519PublicKey) {\n  return {\n    receiverEd25519PublicKeyB64: encodeBase64(receiverEd25519PublicKey.key),\n    senderEd25519PublicKeyB64: encodeBase64(senderEd25519PublicKey.key),\n    senderX25519PublicKeyB64: encodeBase64(senderEphemeralX25519PublicKey.key),\n    sequence,\n    timestampMillis: Date.now()\n  };\n}\nfunction dangerouslyEncryptAndSignEnvelopeUnvalidated(senderEd25519SecretKey, receiverEd25519PublicKey, metadata, privateMessage, publicMessage, senderEphemeralX25519KeyPair) {\n  const encryptionResult = encryptObject(\n    senderEphemeralX25519KeyPair.secretKey,\n    receiverEd25519PublicKey,\n    privateMessage\n  );\n  const encryptedPrivateMessage = serializeEncryptionResult(encryptionResult);\n  const encryptedPrivateMessageBytes = decodeBase64(encryptedPrivateMessage.securedB64);\n  const serializedPublicMessage = JSON.stringify({ ...publicMessage, _metadata: metadata });\n  const publicMessageBytes = new TextEncoder().encode(serializedPublicMessage);\n  const messageSignature = signEnvelope(publicMessageBytes, encryptedPrivateMessageBytes, senderEd25519SecretKey);\n  return {\n    encryptedPrivateMessage,\n    messageSignature,\n    serializedPublicMessage\n  };\n}\nfunction combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes) {\n  const publicMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(publicMessageBytes);\n  const privateMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(privateMessageBytes);\n  const combinedHash = new Uint8Array(publicMessageBytesHash.length + privateMessageBytesHash.length);\n  combinedHash.set(publicMessageBytesHash);\n  combinedHash.set(privateMessageBytesHash, publicMessageBytesHash.length);\n  return (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(combinedHash);\n}\nfunction signEnvelope(publicMessageBytes, privateMessageBytes, senderEd25519SecretKey) {\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const signatureBytes = signWithEd25519SecretKey(messageHashBytes, senderEd25519SecretKey, \"SECURED_ENVELOPE\");\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(signatureBytes).toString();\n}\nfunction verifyEnvelopeSignature(publicMessageBytes, privateMessageBytes, messageSignatureInput, senderEd25519PublicKey) {\n  const messageSignature = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(messageSignatureInput).toUint8Array());\n  const senderPublicKey = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(senderEd25519PublicKey.key);\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const messageVerified = verifySignature(messageHashBytes, messageSignature, senderPublicKey, \"SECURED_ENVELOPE\");\n  if (!messageVerified) {\n    throw new EnvelopeMessageMismatchError(\"Could not verify SecuredEnvelope signature\", \"messageSignature\");\n  }\n}\nfunction decryptEnvelope(senderEd25519PublicKey, receiverEd25519SecretKey, message) {\n  const { encryptedPrivateMessage, messageSignature, serializedPublicMessage } = message;\n  const publicMessage = JSON.parse(serializedPublicMessage);\n  const rawPrivateMessage = decodeBase64(encryptedPrivateMessage.securedB64);\n  const rawPublicMessage = new TextEncoder().encode(serializedPublicMessage);\n  verifyEnvelopeSignature(rawPublicMessage, rawPrivateMessage, messageSignature, senderEd25519PublicKey);\n  const senderEd25519PublicKeyB64 = encodeBase64(senderEd25519PublicKey.key);\n  const expectedPublicKeyB64 = publicMessage._metadata.senderEd25519PublicKeyB64;\n  if (senderEd25519PublicKeyB64 !== expectedPublicKeyB64) {\n    throw new EnvelopeMessageMismatchError(\n      \"senderEd25519PublicKey in envelope does not match provided receiverEd25519SecretKey\",\n      \"senderPublicKey\"\n    );\n  }\n  const senderX25519PublicKeyBytes = decodeBase64(publicMessage._metadata.senderX25519PublicKeyB64);\n  const senderX25519PublicKey = toKey(senderX25519PublicKeyBytes, \"X25519PublicKey\" /* X25519PublicKey */);\n  const encryptionResult = deserializeEncryptionResult(encryptedPrivateMessage);\n  const privateMessage = decryptObject(\n    senderX25519PublicKey,\n    receiverEd25519SecretKey,\n    encryptionResult.secured,\n    encryptionResult.nonce\n  );\n  ensureMetadataFields(publicMessage._metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return {\n    messageSignature,\n    privateMessage,\n    publicMessage\n  };\n}\n\n// src/serialization.ts\n\n\nfunction serializePublicKeyB64(publicKey) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializePublicKey)(serializer, publicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializePublicKeyB64(publicKeyB64) {\n  const serializedPublicKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(publicKeyB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedPublicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKey)(deserializer);\n}\nfunction deserializeEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(decodeBase64(ed25519PublicKeyB64));\n}\nfunction serializeSignatureB64(signature) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializeSignature)(serializer, signature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializeSignatureB64(signatureB64) {\n  const serializedSignature = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(signatureB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedSignature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializeSignature)(deserializer);\n}\nfunction deserializeEd25519SignatureB64(ed25519SignatureB64) {\n  const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(ed25519SignatureB64).toUint8Array();\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(signatureBytes);\n}\nfunction publicKeyB64FromEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  const publicKey = deserializeEd25519PublicKeyB64(ed25519PublicKeyB64);\n  return serializePublicKeyB64(publicKey);\n}\n\n// src/walletAccounts.ts\n\n\nvar AccountConnectionAction = /* @__PURE__ */ ((AccountConnectionAction2) => {\n  AccountConnectionAction2[\"ADD\"] = \"add\";\n  AccountConnectionAction2[\"REMOVE\"] = \"remove\";\n  return AccountConnectionAction2;\n})(AccountConnectionAction || {});\nfunction deriveAccountTransportEd25519Keypair(ed25519SecretKeyOrSignCallback, publicKey) {\n  const publicKeyBytes = publicKey instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.PublicKey ? publicKey.toUint8Array() : publicKey.key;\n  if (ed25519SecretKeyOrSignCallback instanceof Function) {\n    const seedGeneratorBytes = messageHash(publicKeyBytes, \"TRANSPORT_KEYPAIR\");\n    const signature = ed25519SecretKeyOrSignCallback(seedGeneratorBytes);\n    if (signature instanceof Promise) {\n      return signature.then((value) => ed25519KeypairFromSecret(value.toUint8Array()));\n    }\n    return ed25519KeypairFromSecret(signature.toUint8Array());\n  }\n  const seedBytes = signWithEd25519SecretKey(publicKeyBytes, ed25519SecretKeyOrSignCallback, \"TRANSPORT_KEYPAIR\");\n  return ed25519KeypairFromSecret(seedBytes);\n}\nfunction createSerializedAccountInfo(...[\n  signCallback,\n  publicKey,\n  transportEd25519PublicKey,\n  action,\n  intentId,\n  accountAddress\n]) {\n  const authKey = publicKey.authKey();\n  const finalAccountAddress = accountAddress || authKey.derivedAddress().toString();\n  const publicKeyB64 = serializePublicKeyB64(publicKey);\n  const accountInfo = {\n    accountAddress: finalAccountAddress,\n    action,\n    intentId,\n    publicKeyB64,\n    timestampMillis: Date.now(),\n    transportEd25519PublicKeyB64: encodeBase64(transportEd25519PublicKey.key)\n  };\n  const accountInfoSerialized = JSON.stringify(accountInfo);\n  const accountInfoBytes = new TextEncoder().encode(accountInfoSerialized);\n  const accountInfoHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(accountInfoBytes);\n  const signature = signCallback(messageHash(accountInfoHash, \"ACCOUNT_INFO\"));\n  if (signature instanceof Promise) {\n    return signature.then((value) => ({\n      accountInfoSerialized,\n      signatureB64: serializeSignatureB64(value)\n    }));\n  }\n  return {\n    accountInfoSerialized,\n    signatureB64: serializeSignatureB64(signature)\n  };\n}\nasync function aptosAccountToSerializedInfo(account, intentId) {\n  const signCallback = async (data) => account.sign(data);\n  const transportKey = await deriveAccountTransportEd25519Keypair(signCallback, account.publicKey);\n  return createSerializedAccountInfo(\n    signCallback,\n    account.publicKey,\n    transportKey.publicKey,\n    \"add\" /* ADD */,\n    intentId\n  );\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGlkZW50aXR5LWNvbm5lY3QrY3J5cHRvQDAuMi40X0BhcHRvcy1sYWJzK3RzLXNka0AxLjMwLjBfQGFwdG9zLWxhYnMrd2FsbGV0LXN0YW5kYXJkQDAuMi4wX2FwdG9zQDEuMjEuMC9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDc0Q7QUFDUjtBQUNoQjtBQUNFOztBQUVoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQkFBZ0I7QUFDakI7QUFDQSx5QkFBeUIsMENBQVE7QUFDakM7QUFDQTtBQUNBLDBCQUEwQiwyQ0FBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDJDQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBeUI7QUFDbkQ7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQXlCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrREFBaUIsQ0FBQywwQ0FBUztBQUMzQztBQUNBLGtCQUFrQiwwQ0FBUztBQUMzQixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDBDQUFTO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osNERBQTRELFVBQVU7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2Qyw0REFBUSxJQUFJLGlCQUFpQixJQUFJLFFBQVE7QUFDdEYsd0JBQXdCLDREQUFRO0FBQ2hDO0FBQ0E7QUFDQSxTQUFTLDJDQUFVO0FBQ25CO0FBQ0E7QUFDQSxnQ0FBZ0MsZ0VBQWdCLENBQUMsMkNBQVU7QUFDM0Q7QUFDQTtBQUNBLDRDQUE0QyxtREFBbUQ7QUFDL0Y7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDREQUFRO0FBQ25DO0FBQ0E7O0FBRUE7QUFDMkg7QUFDaEU7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxPQUFPO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELHVCQUF1QjtBQUNsRixtRUFBbUUseUJBQXlCO0FBQzVGLG1GQUFtRixlQUFlO0FBQ2xHO0FBQ0EsK0RBQStELGVBQWUsRUFBRSxpQkFBaUI7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCx1Q0FBdUM7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDREQUFTO0FBQzFDLGtDQUFrQyw0REFBUztBQUMzQztBQUNBO0FBQ0E7QUFDQSxTQUFTLDREQUFTO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxtREFBRztBQUNaO0FBQ0E7QUFDQSwrQkFBK0IsZ0VBQWlCLENBQUMsbURBQUc7QUFDcEQsOEJBQThCLGdFQUFxQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUscUVBQXFFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFRbUM7QUFPUDtBQUM1QjtBQUNBLHlCQUF5QiwwREFBVTtBQUNuQyxFQUFFLDZFQUFrQjtBQUNwQixTQUFTLHdFQUFhO0FBQ3RCO0FBQ0E7QUFDQSw4QkFBOEIsd0VBQWE7QUFDM0MsMkJBQTJCLDREQUFZO0FBQ3ZDLFNBQVMsK0VBQW9CO0FBQzdCO0FBQ0E7QUFDQSxhQUFhLGdFQUFzQjtBQUNuQztBQUNBO0FBQ0EseUJBQXlCLDBEQUFVO0FBQ25DLEVBQUUsNkVBQWtCO0FBQ3BCLFNBQVMsd0VBQWE7QUFDdEI7QUFDQTtBQUNBLDhCQUE4Qix3RUFBYTtBQUMzQywyQkFBMkIsNERBQVk7QUFDdkMsU0FBUywrRUFBb0I7QUFDN0I7QUFDQTtBQUNBLHlCQUF5QixtREFBSTtBQUM3QixhQUFhLGdFQUFpQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ2lFO0FBQ047QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtCQUErQjtBQUNoQztBQUNBLDhDQUE4Qyx5REFBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDREQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXdERTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJ0M21pc29yYWNsZS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AaWRlbnRpdHktY29ubmVjdCtjcnlwdG9AMC4yLjRfQGFwdG9zLWxhYnMrdHMtc2RrQDEuMzAuMF9AYXB0b3MtbGFicyt3YWxsZXQtc3RhbmRhcmRAMC4yLjBfYXB0b3NAMS4yMS4wL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9jcnlwdG8vZGlzdC9pbmRleC5tanM/YmI4YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZW5jckRlY3IudHNcbmltcG9ydCB7IEVkMjU1MTlTaWduYXR1cmUgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBzaGEzXzI1NiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbmltcG9ydCBuYWNsMiBmcm9tIFwidHdlZXRuYWNsXCI7XG5pbXBvcnQgZWQyY3VydmUgZnJvbSBcImVkMmN1cnZlXCI7XG5cbi8vIHNyYy9lcnJvcnMudHNcbnZhciBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xufTtcbnZhciBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yID0gY2xhc3MgX0VudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGZpZWxkKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgIHRoaXMubmFtZSA9IFwiRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIERlY3J5cHRpb25FcnJvciA9IGNsYXNzIF9EZWNyeXB0aW9uRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkRlY3J5cHRpb25FcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRGVjcnlwdGlvbkVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IG5hY2wgZnJvbSBcInR3ZWV0bmFjbFwiO1xudmFyIEtleVR5cGVzID0gLyogQF9fUFVSRV9fICovICgoS2V5VHlwZXMyKSA9PiB7XG4gIEtleVR5cGVzMltcIkVkMjU1MTlQdWJsaWNLZXlcIl0gPSBcIkVkMjU1MTlQdWJsaWNLZXlcIjtcbiAgS2V5VHlwZXMyW1wiRWQyNTUxOVNlY3JldEtleVwiXSA9IFwiRWQyNTUxOVNlY3JldEtleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlQdWJsaWNLZXlcIl0gPSBcIlgyNTUxOVB1YmxpY0tleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlTZWNyZXRLZXlcIl0gPSBcIlgyNTUxOVNlY3JldEtleVwiO1xuICByZXR1cm4gS2V5VHlwZXMyO1xufSkoS2V5VHlwZXMgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlWDI1NTE5S2V5UGFpcigpIHtcbiAgcmV0dXJuIGtleXBhaXJUb1gyNTUxOShuYWNsLmJveC5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gY3JlYXRlRWQyNTUxOUtleVBhaXIoKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gdG9LZXkocmF3S2V5LCB0eXBlKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiByYXdLZXksXG4gICAgdHlwZVxuICB9O1xufVxuZnVuY3Rpb24ga2V5cGFpclRvRWQyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJFZDI1NTE5UHVibGljS2V5XCIgLyogRWQyNTUxOVB1YmxpY0tleSAqLyksXG4gICAgc2VjcmV0S2V5OiB0b0tleShrZXlQYWlyLnNlY3JldEtleSwgXCJFZDI1NTE5U2VjcmV0S2V5XCIgLyogRWQyNTUxOVNlY3JldEtleSAqLylcbiAgfTtcbn1cbmZ1bmN0aW9uIGtleXBhaXJUb1gyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJYMjU1MTlQdWJsaWNLZXlcIiAvKiBYMjU1MTlQdWJsaWNLZXkgKi8pLFxuICAgIHNlY3JldEtleTogdG9LZXkoa2V5UGFpci5zZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKVxuICB9O1xufVxuZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9FZDI1NTE5S2V5cGFpcihhY2NvdW50KSB7XG4gIHJldHVybiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoYWNjb3VudC5zaWduaW5nS2V5LnNlY3JldEtleSk7XG59XG5mdW5jdGlvbiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoZWQyNTUxOVNlY3JldEtleUJ5dGVzKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyLmZyb21TZWVkKGVkMjU1MTlTZWNyZXRLZXlCeXRlcy5zbGljZSgwLCAzMikpKTtcbn1cbmZ1bmN0aW9uIGRlY29kZUJhc2U2NChiYXNlNjRTdHIpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGJhc2U2NFN0ciwgXCJiYXNlNjRcIikpO1xuICB9XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20oYXRvYihiYXNlNjRTdHIpLCAobSkgPT4gbS5jb2RlUG9pbnRBdCgwKSk7XG59XG5mdW5jdGlvbiBlbmNvZGVCYXNlNjQoYnl0ZXMpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGJ5dGVzKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbiAgfVxuICByZXR1cm4gYnRvYShBcnJheS5mcm9tKGJ5dGVzLCAoeCkgPT4gU3RyaW5nLmZyb21Db2RlUG9pbnQoeCkpLmpvaW4oXCJcIikpO1xufVxuZnVuY3Rpb24gY29uY2F0VWludDhhcnJheShhcnJheU9uZSwgYXJyYXlUd28pIHtcbiAgY29uc3QgbWVyZ2VkQXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheU9uZS5sZW5ndGggKyBhcnJheVR3by5sZW5ndGgpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlPbmUpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlUd28sIGFycmF5T25lLmxlbmd0aCk7XG4gIHJldHVybiBtZXJnZWRBcnJheTtcbn1cblxuLy8gc3JjL2VuY3JEZWNyLnRzXG52YXIgU0lHTkFUVVJFX1BSRUZJWCA9IFwiQVBUT1M6OklERU5USVRZX0NPTk5FQ1RcIjtcbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleSwgZXJyb3JLZXlOYW1lKSB7XG4gIGNvbnN0IHgyNTUxOVB1YmxpY0tleSA9IGVkMmN1cnZlLmNvbnZlcnRQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleS5rZXkuc2xpY2UoMCwgMzIpKTtcbiAgaWYgKCF4MjU1MTlQdWJsaWNLZXkpXG4gICAgdGhyb3cgbmV3IEVycm9yKGAke2Vycm9yS2V5TmFtZX0gaXMgbm90IGEgdmFsaWQgRWQyNTUxOSBwdWJsaWMga2V5YCk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlQdWJsaWNLZXksIFwiWDI1NTE5UHVibGljS2V5XCIgLyogWDI1NTE5UHVibGljS2V5ICovKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5U2VjcmV0S2V5VG9YMjU1MTlTZWNyZXRLZXkoZWQyNTUxOVNlY3JldEtleSkge1xuICBjb25zdCB4MjU1MTlTZWNyZXRLZXkgPSBlZDJjdXJ2ZS5jb252ZXJ0U2VjcmV0S2V5KGVkMjU1MTlTZWNyZXRLZXkua2V5LnNsaWNlKDAsIDMyKSk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlTZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jKSB7XG4gIHJldHVybiB7XG4gICAgbm9uY2VCNjQ6IGVuY29kZUJhc2U2NChlbmMubm9uY2UpLFxuICAgIHNlY3VyZWRCNjQ6IGVuY29kZUJhc2U2NChlbmMuc2VjdXJlZClcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW5jcnlwdGlvblJlc3VsdChlbmMpIHtcbiAgcmV0dXJuIHtcbiAgICBub25jZTogZGVjb2RlQmFzZTY0KGVuYy5ub25jZUI2NCksXG4gICAgc2VjdXJlZDogZGVjb2RlQmFzZTY0KGVuYy5zZWN1cmVkQjY0KVxuICB9O1xufVxuZnVuY3Rpb24gZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBkZXMuc2VjdXJlZCwgZGVzLm5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdERpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIGRlcy5zZWN1cmVkLCBkZXMubm9uY2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE1lc3NhZ2Uoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXkgPSBjb252ZXJ0RWQyNTUxOVB1YmxpY0tleVRvWDI1NTE5UHVibGljS2V5KFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBcInJlY2VpdmVyIHB1YmxpYyBrZXlcIlxuICApO1xuICByZXR1cm4gZW5jcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSk7XG59XG5mdW5jdGlvbiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IG5vbmNlID0gbmFjbDIucmFuZG9tQnl0ZXMobmFjbDIuYm94Lm5vbmNlTGVuZ3RoKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKG1lc3NhZ2UpO1xuICBjb25zdCBzZWN1cmVkID0gbmFjbDIuYm94KG1lc3NhZ2VVaW50OCwgbm9uY2UsIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LmtleSwgc2VuZGVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMikpO1xuICByZXR1cm4geyBub25jZSwgc2VjdXJlZCB9O1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSkge1xuICBjb25zdCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSA9IGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoXG4gICAgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIFwicmVjZWl2ZXIgcHVibGljIGtleVwiXG4gICk7XG4gIHJldHVybiBlbmNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVNlY3JldEtleSwgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdERpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIHJldHVybiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0TWVzc2FnZShzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKSB7XG4gIGNvbnN0IHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5ID0gY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleShyZWNlaXZlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4gZGVjcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5UHVibGljS2V5LCByZWNlaXZlclgyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRNZXNzYWdlRGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBsZXQgZGVjcnlwdGVkVWludDg7XG4gIHRyeSB7XG4gICAgZGVjcnlwdGVkVWludDggPSBuYWNsMi5ib3gub3BlbihcbiAgICAgIHNlY3VyZWRNZXNzYWdlLFxuICAgICAgbm9uY2UsXG4gICAgICBzZW5kZXJYMjU1MTlQdWJsaWNLZXkua2V5LnNsaWNlKDAsIDMyKSxcbiAgICAgIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMilcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IERlY3J5cHRpb25FcnJvcihgQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZTogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbiAgaWYgKCFkZWNyeXB0ZWRVaW50OClcbiAgICB0aHJvdyBuZXcgRGVjcnlwdGlvbkVycm9yKFwiQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZVwiKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkZWNyeXB0ZWRVaW50OCk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXkgPSBjb252ZXJ0RWQyNTUxOVNlY3JldEtleVRvWDI1NTE5U2VjcmV0S2V5KHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBjb25zdCBkZWNyeXB0ZWRTdHIgPSBkZWNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWRTdHIpO1xufVxuZnVuY3Rpb24gbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSkge1xuICBjb25zdCBzaWduYXR1cmVQcmVmaXhIYXNoID0gbmV3IFVpbnQ4QXJyYXkoc2hhM18yNTYoYCR7U0lHTkFUVVJFX1BSRUZJWH06OiR7cHVycG9zZX06OmApKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHNoYTNfMjU2KGNvbmNhdFVpbnQ4YXJyYXkoc2lnbmF0dXJlUHJlZml4SGFzaCwgbWVzc2FnZSkpKTtcbn1cbmZ1bmN0aW9uIHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleSwgcHVycG9zZSkge1xuICByZXR1cm4gbmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlSGFzaChtZXNzYWdlLCBwdXJwb3NlKSwgc2lnbmluZ0VkMjU1MTlTZWNyZXRLZXkua2V5KTtcbn1cbmZ1bmN0aW9uIG1ha2VFZDI1NTE5U2VjcmV0S2V5U2lnbkNhbGxiYWNrTm9Eb21haW5TZXBhcmF0aW9uKHNpZ25pbmdFZDI1NTE5U2VjcmV0S2V5KSB7XG4gIHJldHVybiBhc3luYyAobWVzc2FnZSkgPT4gbmV3IEVkMjU1MTlTaWduYXR1cmUobmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleS5rZXkpKTtcbn1cbmZ1bmN0aW9uIHZlcmlmeVNpZ25hdHVyZShtZXNzYWdlLCBzaWduYXR1cmUsIHNpZ25pbmdQdWJsaWNLZXksIHB1cnBvc2UpIHtcbiAgcmV0dXJuIHNpZ25pbmdQdWJsaWNLZXkudmVyaWZ5U2lnbmF0dXJlKHsgbWVzc2FnZTogbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSksIHNpZ25hdHVyZSB9KTtcbn1cbmZ1bmN0aW9uIGhhc2hBbmRWZXJpZnlTaWduYXR1cmUobWVzc2FnZSwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKSB7XG4gIGNvbnN0IG1lc3NhZ2VVaW50OCA9IG1lc3NhZ2UgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gbWVzc2FnZSA6IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShtZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4SGFzaCA9IHNoYTNfMjU2KG1lc3NhZ2VVaW50OCk7XG4gIHJldHVybiB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZVVpbnQ4SGFzaCwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKTtcbn1cblxuLy8gc3JjL3NlY3VyZWRFbnZlbG9wZS50c1xuaW1wb3J0IHsgRWQyNTUxOVB1YmxpY0tleSBhcyBBcHRvc0VkMjU1MTlQdWJsaWNLZXksIEVkMjU1MTlTaWduYXR1cmUgYXMgRWQyNTUxOVNpZ25hdHVyZTIsIEhleCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IHNoYTNfMjU2IGFzIHNoYTNfMjU2MiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbnZhciBSRVFVSVJFRF9GSUVMRFMgPSBbXG4gIFwicmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5QjY0XCIsXG4gIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlbmRlclgyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlcXVlbmNlXCIsXG4gIFwidGltZXN0YW1wTWlsbGlzXCJcbl0uc29ydCgpO1xuZnVuY3Rpb24gZW5zdXJlUHJpdmF0ZVB1YmxpY0ZpZWxkc0Rpc2pvaW50KHByaXZhdGVNZXNzYWdlLCBwdWJsaWNNZXNzYWdlKSB7XG4gIGNvbnN0IGludGVyc2VjdGlvbiA9IE9iamVjdC5rZXlzKHByaXZhdGVNZXNzYWdlKS5maWx0ZXIoKHgpID0+IE9iamVjdC5rZXlzKHB1YmxpY01lc3NhZ2UpLmluY2x1ZGVzKHgpKTtcbiAgaWYgKGludGVyc2VjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmllbGQgPSBpbnRlcnNlY3Rpb25bMF07XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoYEZpZWxkICR7ZmllbGR9IGFwcGVhcnMgaW4gYm90aCBwcml2YXRlIGFuZCBwdWJsaWMgbWVzc2FnZSBmaWVsZHNgLCBmaWVsZCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGVuc3VyZU1ldGFkYXRhRmllbGRzKG1lc3NhZ2UpIHtcbiAgY29uc3QgbWVzc2FnZUtleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlKS5zb3J0KCk7XG4gIGNvbnN0IGV4dHJhRmllbGRzID0gbWVzc2FnZUtleXMuZmlsdGVyKChrZXkpID0+ICFSRVFVSVJFRF9GSUVMRFMuaW5jbHVkZXMoa2V5KSk7XG4gIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBSRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChrZXkpID0+ICFtZXNzYWdlS2V5cy5pbmNsdWRlcyhrZXkpKTtcbiAgaWYgKGV4dHJhRmllbGRzLmxlbmd0aCA+IDAgfHwgbWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgbGV0IGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHMubGVuZ3RoID4gMCA/IGBleHRyYSgke2V4dHJhRmllbGRzLmpvaW4oXCIsIFwiKX0pYCA6IFwiXCI7XG4gICAgY29uc3QgbWlzc2luZ0ZpZWxkc1N0ciA9IG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCA/IGBtaXNzaW5nKCR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9KWAgOiBcIlwiO1xuICAgIGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHNTdHIubGVuZ3RoID4gMCAmJiBtaXNzaW5nRmllbGRzU3RyLmxlbmd0aCA+IDAgPyBgJHtleHRyYUZpZWxkc1N0cn0sIGAgOiBleHRyYUZpZWxkc1N0cjtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIGBQdWJsaWNNZXNzYWdlIG1ldGFkYXRhIGZpZWxkcyBkbyBub3QgY29uZm9ybSB0byBzcGVjOiAke2V4dHJhRmllbGRzU3RyfSR7bWlzc2luZ0ZpZWxkc1N0cn1gLFxuICAgICAgXCJfbWV0YWRhdGFcIlxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplVHJhbnNwb3J0RW52ZWxvcGUodHJhbnNwb3J0RW52ZWxvcGUpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZSA9IEpTT04ucGFyc2UodHJhbnNwb3J0RW52ZWxvcGUuc2VyaWFsaXplZFB1YmxpY01lc3NhZ2UpO1xuICByZXR1cm4ge1xuICAgIC4uLnRyYW5zcG9ydEVudmVsb3BlLFxuICAgIHB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUoc2VuZGVyRWQyNTUxOVNlY3JldEtleSwgc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LCBzZXF1ZW5jZSwgcHVibGljTWVzc2FnZSwgcHJpdmF0ZU1lc3NhZ2UpIHtcbiAgY29uc3Qgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpciA9IGNyZWF0ZVgyNTUxOUtleVBhaXIoKTtcbiAgY29uc3QgbWV0YWRhdGEgPSBjb25zdHJ1Y3RNZXRhZGF0YShcbiAgICBzZW5kZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBzZXF1ZW5jZSxcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnB1YmxpY0tleVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhtZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChcbiAgICBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBtZXRhZGF0YSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlLFxuICAgIHNlbmRlckVwaGVtZXJhbFgyNTUxOUtleVBhaXJcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbnN0cnVjdE1ldGFkYXRhKHNlbmRlckVkMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgc2VxdWVuY2UsIHNlbmRlckVwaGVtZXJhbFgyNTUxOVB1YmxpY0tleSkge1xuICByZXR1cm4ge1xuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleS5rZXkpLFxuICAgIHNlbmRlckVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NChzZW5kZXJFZDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQoc2VuZGVyRXBoZW1lcmFsWDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VxdWVuY2UsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpXG4gIH07XG59XG5mdW5jdGlvbiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1ldGFkYXRhLCBwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSwgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpcikge1xuICBjb25zdCBlbmNyeXB0aW9uUmVzdWx0ID0gZW5jcnlwdE9iamVjdChcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnNlY3JldEtleSxcbiAgICByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksXG4gICAgcHJpdmF0ZU1lc3NhZ2VcbiAgKTtcbiAgY29uc3QgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UgPSBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuY3J5cHRpb25SZXN1bHQpO1xuICBjb25zdCBlbmNyeXB0ZWRQcml2YXRlTWVzc2FnZUJ5dGVzID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCBzZXJpYWxpemVkUHVibGljTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgLi4ucHVibGljTWVzc2FnZSwgX21ldGFkYXRhOiBtZXRhZGF0YSB9KTtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4ge1xuICAgIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLFxuICAgIG1lc3NhZ2VTaWduYXR1cmUsXG4gICAgc2VyaWFsaXplZFB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2MihwdWJsaWNNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2Mihwcml2YXRlTWVzc2FnZUJ5dGVzKTtcbiAgY29uc3QgY29tYmluZWRIYXNoID0gbmV3IFVpbnQ4QXJyYXkocHVibGljTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGggKyBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGgpO1xuICBjb21iaW5lZEhhc2guc2V0KHB1YmxpY01lc3NhZ2VCeXRlc0hhc2gpO1xuICBjb21iaW5lZEhhc2guc2V0KHByaXZhdGVNZXNzYWdlQnl0ZXNIYXNoLCBwdWJsaWNNZXNzYWdlQnl0ZXNIYXNoLmxlbmd0aCk7XG4gIHJldHVybiBzaGEzXzI1NjIoY29tYmluZWRIYXNoKTtcbn1cbmZ1bmN0aW9uIHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpIHtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlSGFzaEJ5dGVzLCBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIHJldHVybiBIZXguZnJvbUhleElucHV0KHNpZ25hdHVyZUJ5dGVzKS50b1N0cmluZygpO1xufVxuZnVuY3Rpb24gdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocHVibGljTWVzc2FnZUJ5dGVzLCBwcml2YXRlTWVzc2FnZUJ5dGVzLCBtZXNzYWdlU2lnbmF0dXJlSW5wdXQsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IG5ldyBFZDI1NTE5U2lnbmF0dXJlMihIZXguZnJvbUhleElucHV0KG1lc3NhZ2VTaWduYXR1cmVJbnB1dCkudG9VaW50OEFycmF5KCkpO1xuICBjb25zdCBzZW5kZXJQdWJsaWNLZXkgPSBuZXcgQXB0b3NFZDI1NTE5UHVibGljS2V5KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBtZXNzYWdlVmVyaWZpZWQgPSB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZUhhc2hCeXRlcywgbWVzc2FnZVNpZ25hdHVyZSwgc2VuZGVyUHVibGljS2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIGlmICghbWVzc2FnZVZlcmlmaWVkKSB7XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoXCJDb3VsZCBub3QgdmVyaWZ5IFNlY3VyZWRFbnZlbG9wZSBzaWduYXR1cmVcIiwgXCJtZXNzYWdlU2lnbmF0dXJlXCIpO1xuICB9XG59XG5mdW5jdGlvbiBkZWNyeXB0RW52ZWxvcGUoc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IHsgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlIH0gPSBtZXNzYWdlO1xuICBjb25zdCBwdWJsaWNNZXNzYWdlID0gSlNPTi5wYXJzZShzZXJpYWxpemVkUHVibGljTWVzc2FnZSk7XG4gIGNvbnN0IHJhd1ByaXZhdGVNZXNzYWdlID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCByYXdQdWJsaWNNZXNzYWdlID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocmF3UHVibGljTWVzc2FnZSwgcmF3UHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpO1xuICBjb25zdCBzZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0ID0gZW5jb2RlQmFzZTY0KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgZXhwZWN0ZWRQdWJsaWNLZXlCNjQgPSBwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YS5zZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0O1xuICBpZiAoc2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NCAhPT0gZXhwZWN0ZWRQdWJsaWNLZXlCNjQpIHtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleSBpbiBlbnZlbG9wZSBkb2VzIG5vdCBtYXRjaCBwcm92aWRlZCByZWNlaXZlckVkMjU1MTlTZWNyZXRLZXlcIixcbiAgICAgIFwic2VuZGVyUHVibGljS2V5XCJcbiAgICApO1xuICB9XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzID0gZGVjb2RlQmFzZTY0KHB1YmxpY01lc3NhZ2UuX21ldGFkYXRhLnNlbmRlclgyNTUxOVB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleSA9IHRvS2V5KHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzLCBcIlgyNTUxOVB1YmxpY0tleVwiIC8qIFgyNTUxOVB1YmxpY0tleSAqLyk7XG4gIGNvbnN0IGVuY3J5cHRpb25SZXN1bHQgPSBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZSA9IGRlY3J5cHRPYmplY3QoXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSxcbiAgICBlbmNyeXB0aW9uUmVzdWx0LnNlY3VyZWQsXG4gICAgZW5jcnlwdGlvblJlc3VsdC5ub25jZVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiB7XG4gICAgbWVzc2FnZVNpZ25hdHVyZSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlXG4gIH07XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uLnRzXG5pbXBvcnQge1xuICBiYXNlNjRUb0J5dGVzLFxuICBieXRlc1RvQmFzZTY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgZGVzZXJpYWxpemVTaWduYXR1cmUsXG4gIHNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgc2VyaWFsaXplU2lnbmF0dXJlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQge1xuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlQdWJsaWNLZXkgYXMgQXB0b3NFZDI1NTE5UHVibGljS2V5MixcbiAgRWQyNTUxOVNpZ25hdHVyZSBhcyBFZDI1NTE5U2lnbmF0dXJlMyxcbiAgSGV4IGFzIEhleDIsXG4gIFNlcmlhbGl6ZXJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoKTtcbiAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHB1YmxpY0tleSk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0KHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCkpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQocHVibGljS2V5QjY0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRQdWJsaWNLZXkgPSBiYXNlNjRUb0J5dGVzKHB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFB1YmxpY0tleSk7XG4gIHJldHVybiBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgcmV0dXJuIG5ldyBBcHRvc0VkMjU1MTlQdWJsaWNLZXkyKGRlY29kZUJhc2U2NChlZDI1NTE5UHVibGljS2V5QjY0KSk7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcigpO1xuICBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgc2lnbmF0dXJlKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NChzaWduYXR1cmVCNjQpIHtcbiAgY29uc3Qgc2VyaWFsaXplZFNpZ25hdHVyZSA9IGJhc2U2NFRvQnl0ZXMoc2lnbmF0dXJlQjY0KTtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkU2lnbmF0dXJlKTtcbiAgcmV0dXJuIGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVkMjU1MTlTaWduYXR1cmVCNjQoZWQyNTUxOVNpZ25hdHVyZUI2NCkge1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IEhleDIuZnJvbUhleElucHV0KGVkMjU1MTlTaWduYXR1cmVCNjQpLnRvVWludDhBcnJheSgpO1xuICByZXR1cm4gbmV3IEVkMjU1MTlTaWduYXR1cmUzKHNpZ25hdHVyZUJ5dGVzKTtcbn1cbmZ1bmN0aW9uIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgY29uc3QgcHVibGljS2V5ID0gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICByZXR1cm4gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG59XG5cbi8vIHNyYy93YWxsZXRBY2NvdW50cy50c1xuaW1wb3J0IHsgUHVibGljS2V5IGFzIEFwdG9zUHVibGljS2V5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuaW1wb3J0IHsgc2hhM18yNTYgYXMgc2hhM18yNTYzIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvc2hhM1wiO1xudmFyIEFjY291bnRDb25uZWN0aW9uQWN0aW9uID0gLyogQF9fUFVSRV9fICovICgoQWNjb3VudENvbm5lY3Rpb25BY3Rpb24yKSA9PiB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIkFERFwiXSA9IFwiYWRkXCI7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIlJFTU9WRVwiXSA9IFwicmVtb3ZlXCI7XG4gIHJldHVybiBBY2NvdW50Q29ubmVjdGlvbkFjdGlvbjI7XG59KShBY2NvdW50Q29ubmVjdGlvbkFjdGlvbiB8fCB7fSk7XG5mdW5jdGlvbiBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBwdWJsaWNLZXkpIHtcbiAgY29uc3QgcHVibGljS2V5Qnl0ZXMgPSBwdWJsaWNLZXkgaW5zdGFuY2VvZiBBcHRvc1B1YmxpY0tleSA/IHB1YmxpY0tleS50b1VpbnQ4QXJyYXkoKSA6IHB1YmxpY0tleS5rZXk7XG4gIGlmIChlZDI1NTE5U2VjcmV0S2V5T3JTaWduQ2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHNlZWRHZW5lcmF0b3JCeXRlcyA9IG1lc3NhZ2VIYXNoKHB1YmxpY0tleUJ5dGVzLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGVkMjU1MTlTZWNyZXRLZXlPclNpZ25DYWxsYmFjayhzZWVkR2VuZXJhdG9yQnl0ZXMpO1xuICAgIGlmIChzaWduYXR1cmUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZXR1cm4gc2lnbmF0dXJlLnRoZW4oKHZhbHVlKSA9PiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQodmFsdWUudG9VaW50OEFycmF5KCkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGVkMjU1MTlLZXlwYWlyRnJvbVNlY3JldChzaWduYXR1cmUudG9VaW50OEFycmF5KCkpO1xuICB9XG4gIGNvbnN0IHNlZWRCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShwdWJsaWNLZXlCeXRlcywgZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICByZXR1cm4gZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0KHNlZWRCeXRlcyk7XG59XG5mdW5jdGlvbiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oLi4uW1xuICBzaWduQ2FsbGJhY2ssXG4gIHB1YmxpY0tleSxcbiAgdHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSxcbiAgYWN0aW9uLFxuICBpbnRlbnRJZCxcbiAgYWNjb3VudEFkZHJlc3Ncbl0pIHtcbiAgY29uc3QgYXV0aEtleSA9IHB1YmxpY0tleS5hdXRoS2V5KCk7XG4gIGNvbnN0IGZpbmFsQWNjb3VudEFkZHJlc3MgPSBhY2NvdW50QWRkcmVzcyB8fCBhdXRoS2V5LmRlcml2ZWRBZGRyZXNzKCkudG9TdHJpbmcoKTtcbiAgY29uc3QgcHVibGljS2V5QjY0ID0gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG4gIGNvbnN0IGFjY291bnRJbmZvID0ge1xuICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbEFjY291bnRBZGRyZXNzLFxuICAgIGFjdGlvbixcbiAgICBpbnRlbnRJZCxcbiAgICBwdWJsaWNLZXlCNjQsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpLFxuICAgIHRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NCh0cmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LmtleSlcbiAgfTtcbiAgY29uc3QgYWNjb3VudEluZm9TZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkoYWNjb3VudEluZm8pO1xuICBjb25zdCBhY2NvdW50SW5mb0J5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGFjY291bnRJbmZvU2VyaWFsaXplZCk7XG4gIGNvbnN0IGFjY291bnRJbmZvSGFzaCA9IHNoYTNfMjU2MyhhY2NvdW50SW5mb0J5dGVzKTtcbiAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbkNhbGxiYWNrKG1lc3NhZ2VIYXNoKGFjY291bnRJbmZvSGFzaCwgXCJBQ0NPVU5UX0lORk9cIikpO1xuICBpZiAoc2lnbmF0dXJlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgIHJldHVybiBzaWduYXR1cmUudGhlbigodmFsdWUpID0+ICh7XG4gICAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgICBzaWduYXR1cmVCNjQ6IHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCh2YWx1ZSlcbiAgICB9KSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgc2lnbmF0dXJlQjY0OiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9TZXJpYWxpemVkSW5mbyhhY2NvdW50LCBpbnRlbnRJZCkge1xuICBjb25zdCBzaWduQ2FsbGJhY2sgPSBhc3luYyAoZGF0YSkgPT4gYWNjb3VudC5zaWduKGRhdGEpO1xuICBjb25zdCB0cmFuc3BvcnRLZXkgPSBhd2FpdCBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoc2lnbkNhbGxiYWNrLCBhY2NvdW50LnB1YmxpY0tleSk7XG4gIHJldHVybiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oXG4gICAgc2lnbkNhbGxiYWNrLFxuICAgIGFjY291bnQucHVibGljS2V5LFxuICAgIHRyYW5zcG9ydEtleS5wdWJsaWNLZXksXG4gICAgXCJhZGRcIiAvKiBBREQgKi8sXG4gICAgaW50ZW50SWRcbiAgKTtcbn1cbmV4cG9ydCB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uLFxuICBEZWNyeXB0aW9uRXJyb3IsXG4gIEVuY3J5cHRpb25FbnZlbG9wZUVycm9yLFxuICBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yLFxuICBLZXlUeXBlcyxcbiAgUkVRVUlSRURfRklFTERTLFxuICBTSUdOQVRVUkVfUFJFRklYLFxuICBhcHRvc0FjY291bnRUb0VkMjU1MTlLZXlwYWlyLFxuICBhcHRvc0FjY291bnRUb1NlcmlhbGl6ZWRJbmZvLFxuICBjb25jYXRVaW50OGFycmF5LFxuICBjb25zdHJ1Y3RNZXRhZGF0YSxcbiAgY29udmVydEVkMjU1MTlQdWJsaWNLZXlUb1gyNTUxOVB1YmxpY0tleSxcbiAgY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleSxcbiAgY3JlYXRlRWQyNTUxOUtleVBhaXIsXG4gIGNyZWF0ZVNlcmlhbGl6ZWRBY2NvdW50SW5mbyxcbiAgY3JlYXRlWDI1NTE5S2V5UGFpcixcbiAgZGFuZ2Vyb3VzbHlFbmNyeXB0QW5kU2lnbkVudmVsb3BlVW52YWxpZGF0ZWQsXG4gIGRlY29kZUJhc2U2NCxcbiAgZGVjcnlwdEVudmVsb3BlLFxuICBkZWNyeXB0TWVzc2FnZSxcbiAgZGVjcnlwdE1lc3NhZ2VEaXJlY3QsXG4gIGRlY3J5cHRPYmplY3QsXG4gIGRlY3J5cHRPYmplY3REaXJlY3QsXG4gIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdCxcbiAgZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0RGlyZWN0LFxuICBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIsXG4gIGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgZGVzZXJpYWxpemVFZDI1NTE5U2lnbmF0dXJlQjY0LFxuICBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQsXG4gIGRlc2VyaWFsaXplUHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgZGVzZXJpYWxpemVUcmFuc3BvcnRFbnZlbG9wZSxcbiAgZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0LFxuICBlbmNvZGVCYXNlNjQsXG4gIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUsXG4gIGVuY3J5cHRNZXNzYWdlLFxuICBlbmNyeXB0TWVzc2FnZURpcmVjdCxcbiAgZW5jcnlwdE9iamVjdCxcbiAgZW5jcnlwdE9iamVjdERpcmVjdCxcbiAgZW5zdXJlTWV0YWRhdGFGaWVsZHMsXG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludCxcbiAgaGFzaEFuZFZlcmlmeVNpZ25hdHVyZSxcbiAga2V5cGFpclRvRWQyNTUxOSxcbiAga2V5cGFpclRvWDI1NTE5LFxuICBtYWtlRWQyNTUxOVNlY3JldEtleVNpZ25DYWxsYmFja05vRG9tYWluU2VwYXJhdGlvbixcbiAgbWVzc2FnZUhhc2gsXG4gIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0LFxuICBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0LFxuICBzZXJpYWxpemVQdWJsaWNLZXlCNjQsXG4gIHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgc2lnbldpdGhFZDI1NTE5U2VjcmV0S2V5LFxuICB0b0tleSxcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUsXG4gIHZlcmlmeVNpZ25hdHVyZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@identity-connect+crypto@0.2.4_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@identity-connect/crypto/dist/index.mjs\n");

/***/ })

};
;