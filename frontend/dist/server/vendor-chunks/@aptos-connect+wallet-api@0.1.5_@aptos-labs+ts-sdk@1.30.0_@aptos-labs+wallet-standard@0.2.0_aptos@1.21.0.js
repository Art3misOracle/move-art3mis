"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0";
exports.ids = ["vendor-chunks/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@aptos-connect/wallet-api/dist/index.mjs":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@aptos-connect/wallet-api/dist/index.mjs ***!
  \*******************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AptosWalletErrorResponseMessage: () => (/* binding */ AptosWalletErrorResponseMessage),\n/* harmony export */   AptosWalletRequestMessage: () => (/* binding */ AptosWalletRequestMessage),\n/* harmony export */   AptosWalletSuccessResponseMessage: () => (/* binding */ AptosWalletSuccessResponseMessage),\n/* harmony export */   ConnectRequest: () => (/* binding */ ConnectRequest),\n/* harmony export */   ConnectResponse: () => (/* binding */ ConnectResponse),\n/* harmony export */   DisconnectRequest: () => (/* binding */ DisconnectRequest),\n/* harmony export */   DisconnectResponse: () => (/* binding */ DisconnectResponse),\n/* harmony export */   EntryFunctionArgumentVariant: () => (/* binding */ EntryFunctionArgumentVariant),\n/* harmony export */   GetConnectedAccountsRequest: () => (/* binding */ GetConnectedAccountsRequest),\n/* harmony export */   GetConnectedAccountsResponse: () => (/* binding */ GetConnectedAccountsResponse),\n/* harmony export */   IsConnectedRequest: () => (/* binding */ IsConnectedRequest),\n/* harmony export */   IsConnectedResponse: () => (/* binding */ IsConnectedResponse),\n/* harmony export */   PromptApprovalResponseMessage: () => (/* binding */ PromptApprovalResponseMessage),\n/* harmony export */   PromptOpenerPingRequestMessage: () => (/* binding */ PromptOpenerPingRequestMessage),\n/* harmony export */   PromptOpenerPingResponseMessage: () => (/* binding */ PromptOpenerPingResponseMessage),\n/* harmony export */   PromptUnauthorizedErrorMessage: () => (/* binding */ PromptUnauthorizedErrorMessage),\n/* harmony export */   SignAndSubmitTransactionRequest: () => (/* binding */ SignAndSubmitTransactionRequest),\n/* harmony export */   SignAndSubmitTransactionResponse: () => (/* binding */ SignAndSubmitTransactionResponse),\n/* harmony export */   SignMessageRequest: () => (/* binding */ SignMessageRequest),\n/* harmony export */   SignMessageResponse: () => (/* binding */ SignMessageResponse),\n/* harmony export */   SignTransactionRequest: () => (/* binding */ SignTransactionRequest),\n/* harmony export */   SignTransactionResponse: () => (/* binding */ SignTransactionResponse),\n/* harmony export */   TransactionPayloadInputVariant: () => (/* binding */ TransactionPayloadInputVariant),\n/* harmony export */   base64ToBytes: () => (/* binding */ base64ToBytes),\n/* harmony export */   base64urlToBytes: () => (/* binding */ base64urlToBytes),\n/* harmony export */   bytesToBase64: () => (/* binding */ bytesToBase64),\n/* harmony export */   bytesToBase64url: () => (/* binding */ bytesToBase64url),\n/* harmony export */   chainIdToNetwork: () => (/* binding */ chainIdToNetwork),\n/* harmony export */   decodePopupWalletRequest: () => (/* binding */ decodePopupWalletRequest),\n/* harmony export */   decodeWalletRequestBody: () => (/* binding */ decodeWalletRequestBody),\n/* harmony export */   deserializeAccountAuthenticatorInput: () => (/* binding */ deserializeAccountAuthenticatorInput),\n/* harmony export */   deserializeAccountInfo: () => (/* binding */ deserializeAccountInfo),\n/* harmony export */   deserializeAccountInput: () => (/* binding */ deserializeAccountInput),\n/* harmony export */   deserializeDappInfo: () => (/* binding */ deserializeDappInfo),\n/* harmony export */   deserializeEntryFunctionArgument: () => (/* binding */ deserializeEntryFunctionArgument),\n/* harmony export */   deserializePublicKey: () => (/* binding */ deserializePublicKey),\n/* harmony export */   deserializeSignature: () => (/* binding */ deserializeSignature),\n/* harmony export */   deserializeTransactionPayloadInput: () => (/* binding */ deserializeTransactionPayloadInput),\n/* harmony export */   deserializeWalletRequest: () => (/* binding */ deserializeWalletRequest),\n/* harmony export */   deserializeWalletRequestWithArgs: () => (/* binding */ deserializeWalletRequestWithArgs),\n/* harmony export */   deserializeWalletResponse: () => (/* binding */ deserializeWalletResponse),\n/* harmony export */   encodePopupWalletRequest: () => (/* binding */ encodePopupWalletRequest),\n/* harmony export */   encodeWalletRequestBody: () => (/* binding */ encodeWalletRequestBody),\n/* harmony export */   isAptosWalletResponseMessage: () => (/* binding */ isAptosWalletResponseMessage),\n/* harmony export */   isSupportedNetwork: () => (/* binding */ isSupportedNetwork),\n/* harmony export */   isTypedMessage: () => (/* binding */ isTypedMessage),\n/* harmony export */   makePopupWalletRequestChallenge: () => (/* binding */ makePopupWalletRequestChallenge),\n/* harmony export */   makeUserApproval: () => (/* binding */ makeUserApproval),\n/* harmony export */   makeUserResponseDeserializeFn: () => (/* binding */ makeUserResponseDeserializeFn),\n/* harmony export */   makeUserResponseSerializeFn: () => (/* binding */ makeUserResponseSerializeFn),\n/* harmony export */   serializeAccountAuthenticatorInput: () => (/* binding */ serializeAccountAuthenticatorInput),\n/* harmony export */   serializeAccountInfo: () => (/* binding */ serializeAccountInfo),\n/* harmony export */   serializeAccountInput: () => (/* binding */ serializeAccountInput),\n/* harmony export */   serializeDappInfo: () => (/* binding */ serializeDappInfo),\n/* harmony export */   serializeEntryFunctionArgument: () => (/* binding */ serializeEntryFunctionArgument),\n/* harmony export */   serializePublicKey: () => (/* binding */ serializePublicKey),\n/* harmony export */   serializeSignature: () => (/* binding */ serializeSignature),\n/* harmony export */   serializeTransactionPayloadInput: () => (/* binding */ serializeTransactionPayloadInput),\n/* harmony export */   serializeWalletRequest: () => (/* binding */ serializeWalletRequest),\n/* harmony export */   serializeWalletRequestWithArgs: () => (/* binding */ serializeWalletRequestWithArgs),\n/* harmony export */   serializeWalletResponse: () => (/* binding */ serializeWalletResponse),\n/* harmony export */   urlDecodeWalletRequest: () => (/* binding */ urlDecodeWalletRequest),\n/* harmony export */   urlEncodeWalletRequest: () => (/* binding */ urlEncodeWalletRequest)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/.pnpm/@aptos-labs+ts-sdk@1.30.0/node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n// src/base64.ts\nfunction base64ToBytes(base64) {\n  const binaryString = atob(base64);\n  return Uint8Array.from(binaryString, (m) => m.charCodeAt(0));\n}\nfunction bytesToBase64(bytes) {\n  const binaryString = String.fromCharCode(...bytes);\n  return btoa(binaryString);\n}\nfunction base64urlToBytes(base64) {\n  return base64ToBytes(base64.replace(/-/g, \"+\").replace(/_/g, \"/\"));\n}\nfunction bytesToBase64url(bytes) {\n  return bytesToBase64(bytes).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n}\n\n// src/helpers.ts\n\nfunction chainIdToNetwork(chainId) {\n  switch (chainId) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.NetworkToChainId.mainnet:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.MAINNET;\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.NetworkToChainId.testnet:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.TESTNET;\n    default:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.DEVNET;\n  }\n}\nfunction isSupportedNetwork(network) {\n  return [_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.MAINNET, _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.TESTNET, _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.DEVNET].includes(network);\n}\n\n// src/features/connect/request.ts\n\n\n// src/WalletRequest.ts\n\n\n// src/shared/AccountAuthenticatorInput.ts\n\nfunction serializeAccountAuthenticatorInput(serializer, value) {\n  serializer.serialize(value.address);\n  serializer.serialize(value.authenticator);\n}\nfunction deserializeAccountAuthenticatorInput(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const authenticator = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator);\n  return { address, authenticator };\n}\n\n// src/shared/AccountInfo.ts\n\n\n// src/shared/PublicKey.ts\n\nfunction serializePublicKey(serializer, value) {\n  if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519PublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnyPublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiKey);\n  } else {\n    throw new Error(\"Unexpected public key type\");\n  }\n  serializer.serialize(value);\n}\nfunction deserializePublicKey(deserializer) {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519PublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnyPublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiKey);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n\n// src/shared/AccountInfo.ts\nfunction serializeAccountInfo(serializer, value) {\n  serializer.serialize(value.address);\n  serializePublicKey(serializer, value.publicKey);\n  serializer.serializeStr(value.name ?? \"\");\n}\nfunction deserializeAccountInfo(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const publicKey = deserializePublicKey(deserializer);\n  const name = deserializer.deserializeStr();\n  return {\n    address,\n    publicKey,\n    ...name.length > 0 ? { name } : void 0\n  };\n}\n\n// src/shared/AccountInput.ts\n\nfunction serializeAccountInput(serializer, value) {\n  serializer.serialize(value.address);\n  serializer.serializeBool(value.publicKey !== void 0);\n  if (value.publicKey) {\n    serializePublicKey(serializer, value.publicKey);\n  }\n}\nfunction deserializeAccountInput(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const hasPublicKey = deserializer.deserializeBool();\n  const publicKey = hasPublicKey ? deserializePublicKey(deserializer) : void 0;\n  return { address, publicKey };\n}\n\n// src/shared/DappInfo.ts\nfunction serializeDappInfo(serializer, value) {\n  serializer.serializeStr(value.domain);\n  serializer.serializeStr(value.name);\n  serializer.serializeBool(value.imageURI !== void 0);\n  if (value.imageURI !== void 0) {\n    serializer.serializeStr(value.imageURI);\n  }\n}\nfunction deserializeDappInfo(deserializer) {\n  const domain = deserializer.deserializeStr();\n  const name = deserializer.deserializeStr();\n  const hasImageUri = deserializer.deserializeBool();\n  const imageURI = hasImageUri ? deserializer.deserializeStr() : void 0;\n  return { domain, imageURI, name };\n}\n\n// src/shared/EntryFunctionArgument.ts\n\nvar EntryFunctionArgumentVariant = /* @__PURE__ */ ((EntryFunctionArgumentVariant2) => {\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Undefined\"] = 0] = \"Undefined\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Array\"] = 1] = \"Array\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"String\"] = 2] = \"String\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Uint8Array\"] = 3] = \"Uint8Array\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"AccountAddress\"] = 4] = \"AccountAddress\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"FixedBytes\"] = 5] = \"FixedBytes\";\n  return EntryFunctionArgumentVariant2;\n})(EntryFunctionArgumentVariant || {});\nfunction serializeEntryFunctionArgument(serializer, argument) {\n  if (argument === void 0 || argument === null) {\n    serializer.serializeU32AsUleb128(0 /* Undefined */);\n    return;\n  }\n  if (Array.isArray(argument)) {\n    serializer.serializeU32AsUleb128(1 /* Array */);\n    serializer.serializeU32AsUleb128(argument.length);\n    for (const subArgument of argument) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n  if (typeof argument === \"string\" || typeof argument === \"number\" || typeof argument === \"boolean\" || typeof argument === \"bigint\") {\n    serializer.serializeU32AsUleb128(2 /* String */);\n    serializer.serializeStr(argument.toString());\n    return;\n  }\n  if (argument instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(3 /* Uint8Array */);\n    serializer.serializeBytes(argument);\n    return;\n  }\n  if (argument instanceof ArrayBuffer) {\n    serializer.serializeU32AsUleb128(3 /* Uint8Array */);\n    serializer.serializeBytes(new Uint8Array(argument));\n    return;\n  }\n  if (\"values\" in argument) {\n    serializer.serializeU32AsUleb128(1 /* Array */);\n    serializer.serializeU32AsUleb128(argument.values.length);\n    for (const subArgument of argument.values) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n  if (\"data\" in argument) {\n    serializer.serializeU32AsUleb128(4 /* AccountAddress */);\n    serializer.serialize(argument);\n    return;\n  }\n  if (argument.value === void 0) {\n    serializer.serializeU32AsUleb128(0 /* Undefined */);\n    serializer.serialize(argument);\n    return;\n  }\n  if (argument.value instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(5 /* FixedBytes */);\n    serializer.serializeBytes(argument.value);\n    return;\n  }\n  serializer.serializeU32AsUleb128(2 /* String */);\n  serializer.serializeStr(argument.value.toString());\n}\nfunction deserializeEntryFunctionArgument(deserializer) {\n  const variant = deserializer.deserializeUleb128AsU32();\n  switch (variant) {\n    case 0 /* Undefined */: {\n      return void 0;\n    }\n    case 1 /* Array */: {\n      const length = deserializer.deserializeUleb128AsU32();\n      const args = [];\n      for (let i = 0; i < length; i += 1) {\n        const argument = deserializeEntryFunctionArgument(deserializer);\n        args.push(argument);\n      }\n      return args;\n    }\n    case 3 /* Uint8Array */: {\n      return deserializer.deserializeBytes();\n    }\n    case 4 /* AccountAddress */: {\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n    }\n    case 2 /* String */: {\n      return deserializer.deserializeStr();\n    }\n    case 5 /* FixedBytes */: {\n      const bytes = deserializer.deserializeBytes();\n      return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.FixedBytes(bytes);\n    }\n    default: {\n      throw new Error(\"Unexpected variant\");\n    }\n  }\n}\n\n// src/shared/Signature.ts\n\nfunction serializeSignature(serializer, value) {\n  if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519Signature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnySignature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey);\n  } else {\n    throw new Error(\"Unexpected signature type\");\n  }\n  serializer.serialize(value);\n}\nfunction deserializeSignature(deserializer) {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519Signature);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnySignature);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n\n// src/shared/TransactionPayloadInput.ts\n\nvar TransactionPayloadInputVariant = /* @__PURE__ */ ((TransactionPayloadInputVariant2) => {\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"EntryFunction\"] = 0] = \"EntryFunction\";\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"Script\"] = 1] = \"Script\";\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"Multisig\"] = 2] = \"Multisig\";\n  return TransactionPayloadInputVariant2;\n})(TransactionPayloadInputVariant || {});\nfunction serializeTypeArguments(serializer, typeArguments) {\n  serializer.serializeU32AsUleb128(typeArguments.length);\n  for (const typeArgument of typeArguments) {\n    const typeTag = typeof typeArgument === \"string\" ? (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.parseTypeTag)(typeArgument, { allowGenerics: true }) : typeArgument;\n    serializer.serialize(typeTag);\n  }\n}\nfunction deserializeTypeArguments(deserializer) {\n  const typeArguments = [];\n  const typeArgumentsLength = deserializer.deserializeUleb128AsU32();\n  for (let i = 0; i < typeArgumentsLength; i += 1) {\n    const typeTag = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TypeTag);\n    typeArguments.push(typeTag);\n  }\n  return typeArguments;\n}\nfunction serializeEntryFunctionArguments(serializer, functionArguments) {\n  serializer.serializeU32AsUleb128(functionArguments.length);\n  for (const functionArgument of functionArguments) {\n    serializeEntryFunctionArgument(serializer, functionArgument);\n  }\n}\nfunction deserializeEntryFunctionArguments(deserializer) {\n  const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n  const functionArguments = [];\n  for (let i = 0; i < functionArgumentsLength; i += 1) {\n    const functionArgument = deserializeEntryFunctionArgument(deserializer);\n    functionArguments.push(functionArgument);\n  }\n  return functionArguments;\n}\nfunction serializeTransactionPayloadInput(serializer, value) {\n  if (\"multisigAddress\" in value) {\n    serializer.serializeU32AsUleb128(2 /* Multisig */);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n    const multisigAddress = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress.from(value.multisigAddress);\n    serializer.serialize(multisigAddress);\n  } else if (\"function\" in value) {\n    serializer.serializeU32AsUleb128(0 /* EntryFunction */);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n  } else {\n    serializer.serializeU32AsUleb128(1 /* Script */);\n    const bytecode = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(value.bytecode);\n    serializer.serializeBytes(bytecode.toUint8Array());\n    serializer.serializeU32AsUleb128(value.functionArguments.length);\n    for (const argument of value.functionArguments) {\n      argument.serializeForScriptFunction(serializer);\n    }\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n  }\n}\nfunction deserializeTransactionPayloadInput(deserializer) {\n  const variant = deserializer.deserializeUleb128AsU32();\n  switch (variant) {\n    case 2 /* Multisig */: {\n      const functionId = deserializer.deserializeStr();\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      const multisigAddress = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n      return {\n        function: functionId,\n        functionArguments,\n        multisigAddress,\n        typeArguments\n      };\n    }\n    case 0 /* EntryFunction */: {\n      const functionId = deserializer.deserializeStr();\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        function: functionId,\n        functionArguments,\n        typeArguments\n      };\n    }\n    case 1 /* Script */: {\n      const bytecode = deserializer.deserializeBytes();\n      const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n      const functionArguments = [];\n      for (let i = 0; i < functionArgumentsLength; i += 1) {\n        const argument = (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.deserializeFromScriptArgument)(deserializer);\n        functionArguments.push(argument);\n      }\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        bytecode,\n        functionArguments,\n        typeArguments\n      };\n    }\n    default: {\n      throw new Error(\"Unexpected variant\");\n    }\n  }\n}\n\n// src/WalletRequest.ts\nfunction serializeWalletRequest({\n  dappInfo,\n  name,\n  version\n}) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\nfunction deserializeWalletRequest({\n  data,\n  name,\n  version\n}) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  return { dappInfo, name, version };\n}\nfunction serializeWalletRequestWithArgs({ args, dappInfo, name, version }, serializeArgsFn) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  serializeArgsFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\nfunction deserializeWalletRequestWithArgs({ data, name, version }, deserializeArgsFn) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  const args = deserializeArgsFn(deserializer);\n  return { args, dappInfo, name, version };\n}\n\n// src/features/connect/request.ts\nvar ConnectRequest;\n((ConnectRequest2) => {\n  ConnectRequest2.name = \"connect\";\n  ConnectRequest2.supportedVersions = [1, 2, 3, 4];\n  ConnectRequest2.currentVersion = 4;\n  function serializeArgs(serializer, value) {\n    serializer.serializeOptionStr(value.dappId);\n    serializer.serializeOptionStr(value.dappEd25519PublicKeyB64);\n    serializer.serializeOptionStr(value.preferredWalletName);\n    serializer.serializeBool(value.claimOptions !== void 0);\n    if (value.claimOptions) {\n      serializer.serialize(value.claimOptions.secretKey);\n      serializer.serializeStr(value.claimOptions.network);\n      serializer.serializeOptionStr(value.claimOptions.asset);\n      if (!isSupportedNetwork(value.claimOptions.network)) {\n        throw new Error(`Unsupported network '${value.claimOptions.network}'`);\n      }\n    }\n  }\n  ConnectRequest2.serializeArgs = serializeArgs;\n  function deserializeArgs(deserializer, version) {\n    if (version === 1) {\n      return {};\n    }\n    const dappId = deserializer.deserializeOptionStr();\n    const dappEd25519PublicKeyB64 = deserializer.deserializeOptionStr();\n    const preferredWalletName = version >= 3 ? deserializer.deserializeOptionStr() : void 0;\n    const hasClaimOptions = version >= 4 ? deserializer.deserializeBool() : false;\n    let claimOptions;\n    if (hasClaimOptions) {\n      const secretKey = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PrivateKey);\n      const network = deserializer.deserializeStr();\n      const asset = deserializer.deserializeOptionStr();\n      if (!isSupportedNetwork(network)) {\n        throw new Error(`Unsupported network '${network}'`);\n      }\n      claimOptions = { asset, network, secretKey };\n    }\n    return { claimOptions, dappEd25519PublicKeyB64, dappId, preferredWalletName };\n  }\n  ConnectRequest2.deserializeArgs = deserializeArgs;\n  function serialize(dappInfo, args = {}) {\n    return serializeWalletRequestWithArgs({ args, dappInfo, name: ConnectRequest2.name, version: ConnectRequest2.currentVersion }, serializeArgs);\n  }\n  ConnectRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequestWithArgs(request, (d) => deserializeArgs(d, request.version));\n  }\n  ConnectRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === ConnectRequest2.name && ConnectRequest2.supportedVersions.includes(request.version);\n  }\n  ConnectRequest2.isSerialized = isSerialized;\n})(ConnectRequest || (ConnectRequest = {}));\n\n// src/UserResponse.ts\nfunction makeUserApproval(args) {\n  return { args, status: \"approved\" };\n}\nfunction makeUserResponseSerializeFn(serializeArgs) {\n  return (serializer, value) => {\n    serializer.serializeBool(value.status === \"approved\");\n    if (value.status === \"approved\") {\n      serializeArgs(serializer, value.args);\n    }\n  };\n}\nfunction makeUserResponseDeserializeFn(deserializeArgs) {\n  return (deserializer) => {\n    const isApproved = deserializer.deserializeBool();\n    return isApproved ? { args: deserializeArgs(deserializer), status: \"approved\" } : { status: \"dismissed\" };\n  };\n}\n\n// src/WalletResponse.ts\n\nfunction serializeWalletResponse(args, serializeFn) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data };\n}\nfunction deserializeWalletResponse({ data }, deserializeFn) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const args = deserializeFn(deserializer);\n  return { args };\n}\n\n// src/features/connect/response.ts\nvar ConnectResponse;\n((ConnectResponse2) => {\n  ConnectResponse2.supportedVersions = [1, 2];\n  ConnectResponse2.currentVersion = 2;\n  function serializeApprovalArgsV1(serializer, value) {\n    serializeAccountInfo(serializer, value.account);\n  }\n  function serializeApprovalArgs(serializer, value) {\n    serializeAccountInfo(serializer, value.account);\n    serializer.serializeOptionStr(value.pairing !== void 0 ? JSON.stringify(value.pairing) : void 0);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const account = deserializeAccountInfo(deserializer);\n    const serializedPairing = deserializer.deserializeOptionStr();\n    const pairing = serializedPairing !== void 0 ? JSON.parse(serializedPairing) : void 0;\n    return { account, pairing };\n  }\n  const serializeArgsV1 = makeUserResponseSerializeFn(serializeApprovalArgsV1);\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args, version = ConnectResponse2.currentVersion) {\n    return serializeWalletResponse(args, version === 1 ? serializeArgsV1 : serializeArgs);\n  }\n  ConnectResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  ConnectResponse2.deserialize = deserialize;\n})(ConnectResponse || (ConnectResponse = {}));\n\n// src/features/disconnect/request.ts\nvar DisconnectRequest;\n((DisconnectRequest2) => {\n  DisconnectRequest2.name = \"disconnect\";\n  DisconnectRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: DisconnectRequest2.name, version: DisconnectRequest2.currentVersion });\n  }\n  DisconnectRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  DisconnectRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === DisconnectRequest2.name && request.version === DisconnectRequest2.currentVersion;\n  }\n  DisconnectRequest2.isSerialized = isSerialized;\n})(DisconnectRequest || (DisconnectRequest = {}));\n\n// src/features/disconnect/response.ts\nvar DisconnectResponse;\n((DisconnectResponse2) => {\n  function serialize(args) {\n    return serializeWalletResponse(args, () => {\n    });\n  }\n  DisconnectResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, () => ({}));\n  }\n  DisconnectResponse2.deserialize = deserialize;\n})(DisconnectResponse || (DisconnectResponse = {}));\n\n// src/features/getConnectedAccounts/request.ts\nvar GetConnectedAccountsRequest;\n((GetConnectedAccountsRequest2) => {\n  GetConnectedAccountsRequest2.name = \"getConnectedAccounts\";\n  GetConnectedAccountsRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: GetConnectedAccountsRequest2.name, version: GetConnectedAccountsRequest2.currentVersion });\n  }\n  GetConnectedAccountsRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  GetConnectedAccountsRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === GetConnectedAccountsRequest2.name && request.version === GetConnectedAccountsRequest2.currentVersion;\n  }\n  GetConnectedAccountsRequest2.isSerialized = isSerialized;\n})(GetConnectedAccountsRequest || (GetConnectedAccountsRequest = {}));\n\n// src/features/getConnectedAccounts/response.ts\nvar GetConnectedAccountsResponse;\n((GetConnectedAccountsResponse2) => {\n  function serializeArgs(serializer, args) {\n    serializer.serializeU32AsUleb128(args.length);\n    for (const account of args) {\n      serializeAccountInfo(serializer, account);\n    }\n  }\n  function deserializeArgs(deserializer) {\n    const length = deserializer.deserializeUleb128AsU32();\n    const accounts = [];\n    for (let i = 0; i < length; i += 1) {\n      accounts.push(deserializeAccountInfo(deserializer));\n    }\n    return accounts;\n  }\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  GetConnectedAccountsResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  GetConnectedAccountsResponse2.deserialize = deserialize;\n})(GetConnectedAccountsResponse || (GetConnectedAccountsResponse = {}));\n\n// src/features/isConnected/request.ts\nvar IsConnectedRequest;\n((IsConnectedRequest2) => {\n  IsConnectedRequest2.name = \"isConnected\";\n  IsConnectedRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: IsConnectedRequest2.name, version: IsConnectedRequest2.currentVersion });\n  }\n  IsConnectedRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  IsConnectedRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === IsConnectedRequest2.name && request.version === IsConnectedRequest2.currentVersion;\n  }\n  IsConnectedRequest2.isSerialized = isSerialized;\n})(IsConnectedRequest || (IsConnectedRequest = {}));\n\n// src/features/isConnected/response.ts\nvar IsConnectedResponse;\n((IsConnectedResponse2) => {\n  function serializeArgs(serializer, value) {\n    serializer.serializeBool(value);\n  }\n  function deserializeArgs(deserializer) {\n    return deserializer.deserializeBool();\n  }\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  IsConnectedResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  IsConnectedResponse2.deserialize = deserialize;\n})(IsConnectedResponse || (IsConnectedResponse = {}));\n\n// src/features/signAndSubmitTransaction/request.ts\n\nvar SignAndSubmitTransactionRequest;\n((SignAndSubmitTransactionRequest2) => {\n  SignAndSubmitTransactionRequest2.name = \"signAndSubmitTransaction\";\n  SignAndSubmitTransactionRequest2.supportedVersions = [1, 2, 3];\n  SignAndSubmitTransactionRequest2.currentVersion = 3;\n  function serializeArgs(serializer, value) {\n    if (value.network !== void 0 && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeOptionStr(value.network);\n    if (\"bcsToBytes\" in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n    serializer.serializeU32AsUleb128(value.feePayer ? 1 : 0);\n    if (value.feePayer) {\n      serializeAccountAuthenticatorInput(serializer, value.feePayer);\n    }\n  }\n  SignAndSubmitTransactionRequest2.serializeArgs = serializeArgs;\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOptionStr();\n    if (network !== void 0 && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n    const isPayloadBcsSerializable = version === 1 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload) : deserializeTransactionPayloadInput(deserializer);\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeUleb128AsU32();\n    const feePayer = hasFeePayer ? deserializeAccountAuthenticatorInput(deserializer) : void 0;\n    return {\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : void 0,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : void 0,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : void 0,\n      network,\n      payload,\n      signerAddress\n    };\n  }\n  SignAndSubmitTransactionRequest2.deserializeArgs = deserializeArgs;\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignAndSubmitTransactionRequest2.name, version: SignAndSubmitTransactionRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignAndSubmitTransactionRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(\n      serializedRequest,\n      (deserializer) => deserializeArgs(deserializer, serializedRequest.version)\n    );\n  }\n  SignAndSubmitTransactionRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignAndSubmitTransactionRequest2.name && SignAndSubmitTransactionRequest2.supportedVersions.includes(request.version);\n  }\n  SignAndSubmitTransactionRequest2.isSerialized = isSerialized;\n})(SignAndSubmitTransactionRequest || (SignAndSubmitTransactionRequest = {}));\n\n// src/features/signAndSubmitTransaction/response.ts\nvar SignAndSubmitTransactionResponse;\n((SignAndSubmitTransactionResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serializeStr(value.txnHash);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const txnHash = deserializer.deserializeStr();\n    return { txnHash };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignAndSubmitTransactionResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignAndSubmitTransactionResponse2.deserialize = deserialize;\n})(SignAndSubmitTransactionResponse || (SignAndSubmitTransactionResponse = {}));\n\n// src/features/signMessage/request.ts\n\nvar SignMessageRequest;\n((SignMessageRequest2) => {\n  SignMessageRequest2.name = \"signMessage\";\n  SignMessageRequest2.supportedVersions = [1, 2];\n  SignMessageRequest2.currentVersion = 2;\n  function serializeArgs(serializer, value) {\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeU8(value.chainId);\n    serializer.serializeBytes(value.nonce);\n    serializer.serializeBytes(value.message);\n  }\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 2 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const chainId = deserializer.deserializeU8();\n    const nonce = deserializer.deserializeBytes();\n    const message = deserializer.deserializeBytes();\n    return { chainId, message, nonce, signerAddress };\n  }\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignMessageRequest2.name, version: SignMessageRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignMessageRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(serializedRequest, (d) => deserializeArgs(d, serializedRequest.version));\n  }\n  SignMessageRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignMessageRequest2.name && request.version === SignMessageRequest2.currentVersion;\n  }\n  SignMessageRequest2.isSerialized = isSerialized;\n})(SignMessageRequest || (SignMessageRequest = {}));\n\n// src/features/signMessage/response.ts\nvar SignMessageResponse;\n((SignMessageResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serializeStr(value.fullMessage);\n    serializeSignature(serializer, value.signature);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const fullMessage = deserializer.deserializeStr();\n    const signature = deserializeSignature(deserializer);\n    return { fullMessage, signature };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignMessageResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignMessageResponse2.deserialize = deserialize;\n})(SignMessageResponse || (SignMessageResponse = {}));\n\n// src/features/signTransaction/request.ts\n\nvar SignTransactionRequest;\n((SignTransactionRequest2) => {\n  SignTransactionRequest2.name = \"signTransaction\";\n  SignTransactionRequest2.supportedVersions = [1, 2, 3, 4];\n  SignTransactionRequest2.currentVersion = 4;\n  function normalizeArgs(args) {\n    const { feePayer, secondarySigners, senderPublicKey, signerAddress, transaction } = args;\n    const sender = {\n      address: transaction.sender,\n      publicKey: senderPublicKey\n    };\n    const network = chainIdToNetwork(args.transaction.chain_id.chainId);\n    return {\n      expirationTimestamp: Number(transaction.expiration_timestamp_secs),\n      feePayer,\n      gasUnitPrice: Number(transaction.gas_unit_price),\n      maxGasAmount: Number(transaction.max_gas_amount),\n      network,\n      payload: transaction.payload,\n      secondarySigners,\n      sender,\n      signerAddress\n    };\n  }\n  SignTransactionRequest2.normalizeArgs = normalizeArgs;\n  function serializeArgs(serializer, value) {\n    if (value.network !== void 0 && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeOptionStr(value.network);\n    serializer.serializeBool(value.sender !== void 0);\n    if (value.sender !== void 0) {\n      serializeAccountInput(serializer, value.sender);\n    }\n    if (\"bcsToBytes\" in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n    serializer.serializeU32AsUleb128(value.expirationSecondsFromNow ?? 0);\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n    serializer.serializeBool(value.feePayer !== void 0);\n    if (value.feePayer !== void 0) {\n      serializeAccountInput(serializer, value.feePayer);\n    }\n    const secondarySigners = value.secondarySigners ?? [];\n    serializer.serializeU32AsUleb128(secondarySigners.length);\n    for (const signer of secondarySigners) {\n      serializeAccountInput(serializer, signer);\n    }\n  }\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOptionStr();\n    if (network !== void 0 && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n    const hasSender = deserializer.deserializeBool();\n    const sender = hasSender ? deserializeAccountInput(deserializer) : void 0;\n    const isPayloadBcsSerializable = version < 4 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload) : deserializeTransactionPayloadInput(deserializer);\n    const expirationSecondsFromNow = deserializer.deserializeUleb128AsU32();\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeBool();\n    const feePayer = hasFeePayer ? deserializeAccountInput(deserializer) : void 0;\n    const secondarySignersLength = deserializer.deserializeUleb128AsU32();\n    const secondarySigners = [];\n    for (let i = 0; i < secondarySignersLength; i += 1) {\n      secondarySigners.push(deserializeAccountInput(deserializer));\n    }\n    return {\n      expirationSecondsFromNow: expirationSecondsFromNow > 0 ? expirationSecondsFromNow : void 0,\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : void 0,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : void 0,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : void 0,\n      network,\n      payload,\n      secondarySigners,\n      sender,\n      signerAddress\n    };\n  }\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignTransactionRequest2.name, version: SignTransactionRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignTransactionRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(\n      serializedRequest,\n      (deserializer) => deserializeArgs(deserializer, serializedRequest.version)\n    );\n  }\n  SignTransactionRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignTransactionRequest2.name && SignTransactionRequest2.supportedVersions.includes(request.version);\n  }\n  SignTransactionRequest2.isSerialized = isSerialized;\n})(SignTransactionRequest || (SignTransactionRequest = {}));\n\n// src/features/signTransaction/response.ts\n\nvar SignTransactionResponse;\n((SignTransactionResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serialize(value.authenticator);\n    serializer.serializeBool(value.rawTransaction !== void 0);\n    if (value.rawTransaction !== void 0) {\n      serializer.serialize(value.rawTransaction);\n    }\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const authenticator = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator);\n    const hasRawTransaction = deserializer.deserializeBool();\n    const rawTransaction = hasRawTransaction ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction) : void 0;\n    return {\n      authenticator,\n      rawTransaction\n    };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignTransactionResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignTransactionResponse2.deserialize = deserialize;\n})(SignTransactionResponse || (SignTransactionResponse = {}));\n\n// src/messages/common.ts\nfunction isTypedMessage(messageCls, message) {\n  return message?.__messageType === messageCls.TYPE;\n}\n\n// src/messages/background.ts\nvar _AptosWalletRequestMessage = class _AptosWalletRequestMessage {\n  constructor(nonce, serializedValue) {\n    this.nonce = nonce;\n    this.serializedValue = serializedValue;\n    this.__messageType = _AptosWalletRequestMessage.TYPE;\n  }\n};\n_AptosWalletRequestMessage.TYPE = \"AptosWalletRequest\";\nvar AptosWalletRequestMessage = _AptosWalletRequestMessage;\nvar _AptosWalletSuccessResponseMessage = class _AptosWalletSuccessResponseMessage {\n  constructor(serializedValue, nonce) {\n    this.serializedValue = serializedValue;\n    this.nonce = nonce;\n    this.__messageType = _AptosWalletSuccessResponseMessage.TYPE;\n  }\n};\n_AptosWalletSuccessResponseMessage.TYPE = \"AptosWalletSuccessResponseMessage\";\nvar AptosWalletSuccessResponseMessage = _AptosWalletSuccessResponseMessage;\nvar _AptosWalletErrorResponseMessage = class _AptosWalletErrorResponseMessage {\n  constructor(error, nonce) {\n    this.error = error;\n    this.nonce = nonce;\n    this.__messageType = _AptosWalletErrorResponseMessage.TYPE;\n  }\n};\n_AptosWalletErrorResponseMessage.TYPE = \"AptosWalletErrorResponseMessage\";\nvar AptosWalletErrorResponseMessage = _AptosWalletErrorResponseMessage;\nfunction isAptosWalletResponseMessage(message) {\n  return isTypedMessage(AptosWalletSuccessResponseMessage, message) || isTypedMessage(AptosWalletErrorResponseMessage, message);\n}\n\n// src/messages/prompt.ts\n\nvar _PromptOpenerPingRequestMessage = class _PromptOpenerPingRequestMessage {\n  constructor() {\n    this.__messageType = _PromptOpenerPingRequestMessage.TYPE;\n  }\n};\n_PromptOpenerPingRequestMessage.TYPE = \"PromptOpenerPingRequest\";\nvar PromptOpenerPingRequestMessage = _PromptOpenerPingRequestMessage;\nvar _PromptOpenerPingResponseMessage = class _PromptOpenerPingResponseMessage {\n  constructor() {\n    this.__messageType = _PromptOpenerPingResponseMessage.TYPE;\n  }\n};\n_PromptOpenerPingResponseMessage.TYPE = \"PromptOpenerPingResponse\";\nvar PromptOpenerPingResponseMessage = _PromptOpenerPingResponseMessage;\nvar _PromptApprovalResponseMessage = class _PromptApprovalResponseMessage {\n  constructor(serializedValue) {\n    this.serializedValue = serializedValue;\n    this.__messageType = _PromptApprovalResponseMessage.TYPE;\n  }\n};\n_PromptApprovalResponseMessage.TYPE = \"PromptApprovalResponse\";\nvar PromptApprovalResponseMessage = _PromptApprovalResponseMessage;\nvar _PromptUnauthorizedErrorMessage = class _PromptUnauthorizedErrorMessage {\n  constructor() {\n    this.__messageType = _PromptUnauthorizedErrorMessage.TYPE;\n  }\n};\n_PromptUnauthorizedErrorMessage.TYPE = \"PromptUnauthorizedError\";\nvar PromptUnauthorizedErrorMessage = _PromptUnauthorizedErrorMessage;\nfunction urlEncodeWalletRequest(request) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializer.serializeStr(request.name);\n  serializer.serializeBytes(request.data);\n  serializer.serializeStr(request.version.toString());\n  return bytesToBase64(serializer.toUint8Array());\n}\nfunction urlDecodeWalletRequest(encodedRequest) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(base64ToBytes(encodedRequest));\n  const name = deserializer.deserializeStr();\n  const data = deserializer.deserializeBytes();\n  let version;\n  try {\n    version = Number(deserializer.deserializeStr());\n  } catch {\n    version = 1;\n  }\n  return { data, name, version };\n}\n\n// src/PopupWalletRequest.ts\n\n\n// src/WalletRequestBody.ts\nfunction encodeWalletRequestBody({ data, ...rest }) {\n  const serialized = JSON.stringify({ data, ...rest }, (key, value) => key === \"data\" ? bytesToBase64(value) : value);\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64(utf8Encoded);\n}\nfunction decodeWalletRequestBody(encoded) {\n  const utfEncoded = base64ToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => key === \"data\" ? base64ToBytes(value) : value);\n}\n\n// src/PopupWalletRequest.ts\nfunction encodePopupWalletRequest(request) {\n  const serialized = JSON.stringify(request, (key, value) => {\n    switch (key) {\n      case \"body\":\n        return encodeWalletRequestBody(value);\n      case \"clientIdentityKey\":\n        return bytesToBase64(value.toUint8Array());\n      case \"signature\":\n        return bytesToBase64(value.toUint8Array());\n      default:\n        return value;\n    }\n  });\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64url(utf8Encoded);\n}\nfunction decodePopupWalletRequest(encoded) {\n  const utfEncoded = base64urlToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => {\n    switch (key) {\n      case \"body\":\n        return decodeWalletRequestBody(value);\n      case \"clientIdentityKey\":\n        return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(base64ToBytes(value));\n      case \"signature\":\n        return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(base64ToBytes(value));\n      default:\n        return value;\n    }\n  });\n}\nfunction makePopupWalletRequestChallenge({\n  accountAddress,\n  body,\n  id,\n  timestamp\n}) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializer.serializeStr(\"SignedPopupWalletRequest\");\n  serializer.serializeStr(id);\n  serializer.serializeU64(timestamp);\n  serializer.serializeBool(accountAddress !== void 0);\n  if (accountAddress !== void 0) {\n    serializer.serialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress.from(accountAddress));\n  }\n  serializer.serializeStr(body.name);\n  serializer.serializeU8(body.version);\n  serializer.serializeBytes(body.data);\n  return serializer.toUint8Array();\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGFwdG9zLWNvbm5lY3Qrd2FsbGV0LWFwaUAwLjEuNV9AYXB0b3MtbGFicyt0cy1zZGtAMS4zMC4wX0BhcHRvcy1sYWJzK3dhbGxldC1zdGFuZGFyZEAwLjIuMF9hcHRvc0AxLjIxLjAvbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hcGkvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUMrRDtBQUMvRDtBQUNBO0FBQ0EsU0FBUyxnRUFBZ0I7QUFDekIsYUFBYSx1REFBTztBQUNwQixTQUFTLGdFQUFnQjtBQUN6QixhQUFhLHVEQUFPO0FBQ3BCO0FBQ0EsYUFBYSx1REFBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQSxVQUFVLHVEQUFPLFVBQVUsdURBQU8sVUFBVSx1REFBTztBQUNuRDs7QUFFQTtBQUN1RDs7QUFFdkQ7QUFDOEY7O0FBRTlGO0FBQzBFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsOERBQWM7QUFDekQsaURBQWlELG9FQUFvQjtBQUNyRSxXQUFXO0FBQ1g7O0FBRUE7QUFDdUU7O0FBRXZFO0FBTzRCO0FBQzVCO0FBQ0EsdUJBQXVCLGdFQUFnQjtBQUN2QyxxQ0FBcUMsNkRBQWE7QUFDbEQsSUFBSSwwQkFBMEIscUVBQXFCO0FBQ25ELHFDQUFxQyw2REFBYTtBQUNsRCxJQUFJLDBCQUEwQiw0REFBWTtBQUMxQyxxQ0FBcUMsNkRBQWE7QUFDbEQsSUFBSSwwQkFBMEIsd0RBQVE7QUFDdEMscUNBQXFDLDZEQUFhO0FBQ2xELElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnRUFBaUI7QUFDcEM7QUFDQSxtQkFBbUIsZ0VBQWlCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QseUJBQXlCLDBEQUFZO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOERBQWU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaUVFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcnQzbWlzb3JhY2xlLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhcHRvcy1jb25uZWN0K3dhbGxldC1hcGlAMC4xLjVfQGFwdG9zLWxhYnMrdHMtc2RrQDEuMzAuMF9AYXB0b3MtbGFicyt3YWxsZXQtc3RhbmRhcmRAMC4yLjBfYXB0b3NAMS4yMS4wL25vZGVfbW9kdWxlcy9AYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpL2Rpc3QvaW5kZXgubWpzP2Y5MGUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2Jhc2U2NC50c1xuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyhiYXNlNjQpIHtcbiAgY29uc3QgYmluYXJ5U3RyaW5nID0gYXRvYihiYXNlNjQpO1xuICByZXR1cm4gVWludDhBcnJheS5mcm9tKGJpbmFyeVN0cmluZywgKG0pID0+IG0uY2hhckNvZGVBdCgwKSk7XG59XG5mdW5jdGlvbiBieXRlc1RvQmFzZTY0KGJ5dGVzKSB7XG4gIGNvbnN0IGJpbmFyeVN0cmluZyA9IFN0cmluZy5mcm9tQ2hhckNvZGUoLi4uYnl0ZXMpO1xuICByZXR1cm4gYnRvYShiaW5hcnlTdHJpbmcpO1xufVxuZnVuY3Rpb24gYmFzZTY0dXJsVG9CeXRlcyhiYXNlNjQpIHtcbiAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoYmFzZTY0LnJlcGxhY2UoLy0vZywgXCIrXCIpLnJlcGxhY2UoL18vZywgXCIvXCIpKTtcbn1cbmZ1bmN0aW9uIGJ5dGVzVG9CYXNlNjR1cmwoYnl0ZXMpIHtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoYnl0ZXMpLnJlcGxhY2UoL1xcKy9nLCBcIi1cIikucmVwbGFjZSgvXFwvL2csIFwiX1wiKS5yZXBsYWNlKC89KyQvLCBcIlwiKTtcbn1cblxuLy8gc3JjL2hlbHBlcnMudHNcbmltcG9ydCB7IE5ldHdvcmssIE5ldHdvcmtUb0NoYWluSWQgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBjaGFpbklkVG9OZXR3b3JrKGNoYWluSWQpIHtcbiAgc3dpdGNoIChjaGFpbklkKSB7XG4gICAgY2FzZSBOZXR3b3JrVG9DaGFpbklkLm1haW5uZXQ6XG4gICAgICByZXR1cm4gTmV0d29yay5NQUlOTkVUO1xuICAgIGNhc2UgTmV0d29ya1RvQ2hhaW5JZC50ZXN0bmV0OlxuICAgICAgcmV0dXJuIE5ldHdvcmsuVEVTVE5FVDtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIE5ldHdvcmsuREVWTkVUO1xuICB9XG59XG5mdW5jdGlvbiBpc1N1cHBvcnRlZE5ldHdvcmsobmV0d29yaykge1xuICByZXR1cm4gW05ldHdvcmsuTUFJTk5FVCwgTmV0d29yay5URVNUTkVULCBOZXR3b3JrLkRFVk5FVF0uaW5jbHVkZXMobmV0d29yayk7XG59XG5cbi8vIHNyYy9mZWF0dXJlcy9jb25uZWN0L3JlcXVlc3QudHNcbmltcG9ydCB7IEVkMjU1MTlQcml2YXRlS2V5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuXG4vLyBzcmMvV2FsbGV0UmVxdWVzdC50c1xuaW1wb3J0IHsgRGVzZXJpYWxpemVyIGFzIERlc2VyaWFsaXplcjksIFNlcmlhbGl6ZXIgYXMgU2VyaWFsaXplcjkgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5cbi8vIHNyYy9zaGFyZWQvQWNjb3VudEF1dGhlbnRpY2F0b3JJbnB1dC50c1xuaW1wb3J0IHsgQWNjb3VudEFkZHJlc3MsIEFjY291bnRBdXRoZW50aWNhdG9yIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudEF1dGhlbnRpY2F0b3JJbnB1dChzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5hZGRyZXNzKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuYXV0aGVudGljYXRvcik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUFjY291bnRBdXRoZW50aWNhdG9ySW5wdXQoZGVzZXJpYWxpemVyKSB7XG4gIGNvbnN0IGFkZHJlc3MgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEFkZHJlc3MpO1xuICBjb25zdCBhdXRoZW50aWNhdG9yID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBdXRoZW50aWNhdG9yKTtcbiAgcmV0dXJuIHsgYWRkcmVzcywgYXV0aGVudGljYXRvciB9O1xufVxuXG4vLyBzcmMvc2hhcmVkL0FjY291bnRJbmZvLnRzXG5pbXBvcnQgeyBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5cbi8vIHNyYy9zaGFyZWQvUHVibGljS2V5LnRzXG5pbXBvcnQge1xuICBBbnlQdWJsaWNLZXksXG4gIEVkMjU1MTlQdWJsaWNLZXksXG4gIE11bHRpRWQyNTUxOVB1YmxpY0tleSxcbiAgTXVsdGlLZXksXG4gIFNpZ25pbmdTY2hlbWVcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChTaWduaW5nU2NoZW1lLkVkMjU1MTkpO1xuICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgTXVsdGlFZDI1NTE5UHVibGljS2V5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZS5NdWx0aUVkMjU1MTkpO1xuICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW55UHVibGljS2V5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZS5TaW5nbGVLZXkpO1xuICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgTXVsdGlLZXkpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChTaWduaW5nU2NoZW1lLk11bHRpS2V5KTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIHB1YmxpYyBrZXkgdHlwZVwiKTtcbiAgfVxuICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3Qgc2lnbmluZ1NjaGVtZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICBzd2l0Y2ggKHNpZ25pbmdTY2hlbWUpIHtcbiAgICBjYXNlIFNpZ25pbmdTY2hlbWUuRWQyNTUxOTpcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoRWQyNTUxOVB1YmxpY0tleSk7XG4gICAgY2FzZSBTaWduaW5nU2NoZW1lLk11bHRpRWQyNTUxOTpcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoTXVsdGlFZDI1NTE5UHVibGljS2V5KTtcbiAgICBjYXNlIFNpZ25pbmdTY2hlbWUuU2luZ2xlS2V5OlxuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBbnlQdWJsaWNLZXkpO1xuICAgIGNhc2UgU2lnbmluZ1NjaGVtZS5NdWx0aUtleTpcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoTXVsdGlLZXkpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gc2lnbmluZyBzY2hlbWU6ICR7c2lnbmluZ1NjaGVtZX1gKTtcbiAgfVxufVxuXG4vLyBzcmMvc2hhcmVkL0FjY291bnRJbmZvLnRzXG5mdW5jdGlvbiBzZXJpYWxpemVBY2NvdW50SW5mbyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5hZGRyZXNzKTtcbiAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHZhbHVlLnB1YmxpY0tleSk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLm5hbWUgPz8gXCJcIik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUFjY291bnRJbmZvKGRlc2VyaWFsaXplcikge1xuICBjb25zdCBhZGRyZXNzID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBZGRyZXNzMik7XG4gIGNvbnN0IHB1YmxpY0tleSA9IGRlc2VyaWFsaXplUHVibGljS2V5KGRlc2VyaWFsaXplcik7XG4gIGNvbnN0IG5hbWUgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgcmV0dXJuIHtcbiAgICBhZGRyZXNzLFxuICAgIHB1YmxpY0tleSxcbiAgICAuLi5uYW1lLmxlbmd0aCA+IDAgPyB7IG5hbWUgfSA6IHZvaWQgMFxuICB9O1xufVxuXG4vLyBzcmMvc2hhcmVkL0FjY291bnRJbnB1dC50c1xuaW1wb3J0IHsgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3MzIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudElucHV0KHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLmFkZHJlc3MpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUucHVibGljS2V5ICE9PSB2b2lkIDApO1xuICBpZiAodmFsdWUucHVibGljS2V5KSB7XG4gICAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHZhbHVlLnB1YmxpY0tleSk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplQWNjb3VudElucHV0KGRlc2VyaWFsaXplcikge1xuICBjb25zdCBhZGRyZXNzID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBZGRyZXNzMyk7XG4gIGNvbnN0IGhhc1B1YmxpY0tleSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgY29uc3QgcHVibGljS2V5ID0gaGFzUHVibGljS2V5ID8gZGVzZXJpYWxpemVQdWJsaWNLZXkoZGVzZXJpYWxpemVyKSA6IHZvaWQgMDtcbiAgcmV0dXJuIHsgYWRkcmVzcywgcHVibGljS2V5IH07XG59XG5cbi8vIHNyYy9zaGFyZWQvRGFwcEluZm8udHNcbmZ1bmN0aW9uIHNlcmlhbGl6ZURhcHBJbmZvKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLmRvbWFpbik7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLm5hbWUpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUuaW1hZ2VVUkkgIT09IHZvaWQgMCk7XG4gIGlmICh2YWx1ZS5pbWFnZVVSSSAhPT0gdm9pZCAwKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIodmFsdWUuaW1hZ2VVUkkpO1xuICB9XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZURhcHBJbmZvKGRlc2VyaWFsaXplcikge1xuICBjb25zdCBkb21haW4gPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgY29uc3QgbmFtZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpO1xuICBjb25zdCBoYXNJbWFnZVVyaSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgY29uc3QgaW1hZ2VVUkkgPSBoYXNJbWFnZVVyaSA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpIDogdm9pZCAwO1xuICByZXR1cm4geyBkb21haW4sIGltYWdlVVJJLCBuYW1lIH07XG59XG5cbi8vIHNyYy9zaGFyZWQvRW50cnlGdW5jdGlvbkFyZ3VtZW50LnRzXG5pbXBvcnQge1xuICBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczQsXG4gIEZpeGVkQnl0ZXNcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xudmFyIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQgPSAvKiBAX19QVVJFX18gKi8gKChFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MikgPT4ge1xuICBFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltcIlVuZGVmaW5lZFwiXSA9IDBdID0gXCJVbmRlZmluZWRcIjtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJBcnJheVwiXSA9IDFdID0gXCJBcnJheVwiO1xuICBFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltcIlN0cmluZ1wiXSA9IDJdID0gXCJTdHJpbmdcIjtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJVaW50OEFycmF5XCJdID0gM10gPSBcIlVpbnQ4QXJyYXlcIjtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJBY2NvdW50QWRkcmVzc1wiXSA9IDRdID0gXCJBY2NvdW50QWRkcmVzc1wiO1xuICBFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50MltcIkZpeGVkQnl0ZXNcIl0gPSA1XSA9IFwiRml4ZWRCeXRlc1wiO1xuICByZXR1cm4gRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDI7XG59KShFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50IHx8IHt9KTtcbmZ1bmN0aW9uIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudChzZXJpYWxpemVyLCBhcmd1bWVudCkge1xuICBpZiAoYXJndW1lbnQgPT09IHZvaWQgMCB8fCBhcmd1bWVudCA9PT0gbnVsbCkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDAgLyogVW5kZWZpbmVkICovKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnQpKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMSAvKiBBcnJheSAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoYXJndW1lbnQubGVuZ3RoKTtcbiAgICBmb3IgKGNvbnN0IHN1YkFyZ3VtZW50IG9mIGFyZ3VtZW50KSB7XG4gICAgICBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoc2VyaWFsaXplciwgc3ViQXJndW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHR5cGVvZiBhcmd1bWVudCA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgYXJndW1lbnQgPT09IFwibnVtYmVyXCIgfHwgdHlwZW9mIGFyZ3VtZW50ID09PSBcImJvb2xlYW5cIiB8fCB0eXBlb2YgYXJndW1lbnQgPT09IFwiYmlnaW50XCIpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgyIC8qIFN0cmluZyAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIoYXJndW1lbnQudG9TdHJpbmcoKSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChhcmd1bWVudCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgzIC8qIFVpbnQ4QXJyYXkgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQnl0ZXMoYXJndW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoYXJndW1lbnQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDMgLyogVWludDhBcnJheSAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCeXRlcyhuZXcgVWludDhBcnJheShhcmd1bWVudCkpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoXCJ2YWx1ZXNcIiBpbiBhcmd1bWVudCkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDEgLyogQXJyYXkgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KGFyZ3VtZW50LnZhbHVlcy5sZW5ndGgpO1xuICAgIGZvciAoY29uc3Qgc3ViQXJndW1lbnQgb2YgYXJndW1lbnQudmFsdWVzKSB7XG4gICAgICBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoc2VyaWFsaXplciwgc3ViQXJndW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKFwiZGF0YVwiIGluIGFyZ3VtZW50KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoNCAvKiBBY2NvdW50QWRkcmVzcyAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemUoYXJndW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoYXJndW1lbnQudmFsdWUgPT09IHZvaWQgMCkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDAgLyogVW5kZWZpbmVkICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZShhcmd1bWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChhcmd1bWVudC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCg1IC8qIEZpeGVkQnl0ZXMgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQnl0ZXMoYXJndW1lbnQudmFsdWUpO1xuICAgIHJldHVybjtcbiAgfVxuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgyIC8qIFN0cmluZyAqLyk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKGFyZ3VtZW50LnZhbHVlLnRvU3RyaW5nKCkpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoZGVzZXJpYWxpemVyKSB7XG4gIGNvbnN0IHZhcmlhbnQgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgc3dpdGNoICh2YXJpYW50KSB7XG4gICAgY2FzZSAwIC8qIFVuZGVmaW5lZCAqLzoge1xuICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICB9XG4gICAgY2FzZSAxIC8qIEFycmF5ICovOiB7XG4gICAgICBjb25zdCBsZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICAgIGNvbnN0IGFyZ3MgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3QgYXJndW1lbnQgPSBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudChkZXNlcmlhbGl6ZXIpO1xuICAgICAgICBhcmdzLnB1c2goYXJndW1lbnQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfVxuICAgIGNhc2UgMyAvKiBVaW50OEFycmF5ICovOiB7XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQnl0ZXMoKTtcbiAgICB9XG4gICAgY2FzZSA0IC8qIEFjY291bnRBZGRyZXNzICovOiB7XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBZGRyZXNzNCk7XG4gICAgfVxuICAgIGNhc2UgMiAvKiBTdHJpbmcgKi86IHtcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgICB9XG4gICAgY2FzZSA1IC8qIEZpeGVkQnl0ZXMgKi86IHtcbiAgICAgIGNvbnN0IGJ5dGVzID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQnl0ZXMoKTtcbiAgICAgIHJldHVybiBuZXcgRml4ZWRCeXRlcyhieXRlcyk7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgdmFyaWFudFwiKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gc3JjL3NoYXJlZC9TaWduYXR1cmUudHNcbmltcG9ydCB7XG4gIEFueVNpZ25hdHVyZSxcbiAgRWQyNTUxOVNpZ25hdHVyZSxcbiAgTXVsdGlFZDI1NTE5U2lnbmF0dXJlLFxuICBTaWduaW5nU2NoZW1lIGFzIFNpZ25pbmdTY2hlbWUyXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25hdHVyZShzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFZDI1NTE5U2lnbmF0dXJlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZTIuRWQyNTUxOSk7XG4gIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBNdWx0aUVkMjU1MTlTaWduYXR1cmUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChTaWduaW5nU2NoZW1lMi5NdWx0aUVkMjU1MTkpO1xuICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW55U2lnbmF0dXJlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZTIuU2luZ2xlS2V5KTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIHNpZ25hdHVyZSB0eXBlXCIpO1xuICB9XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcikge1xuICBjb25zdCBzaWduaW5nU2NoZW1lID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gIHN3aXRjaCAoc2lnbmluZ1NjaGVtZSkge1xuICAgIGNhc2UgU2lnbmluZ1NjaGVtZTIuRWQyNTUxOTpcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoRWQyNTUxOVNpZ25hdHVyZSk7XG4gICAgY2FzZSBTaWduaW5nU2NoZW1lMi5NdWx0aUVkMjU1MTk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKE11bHRpRWQyNTUxOVNpZ25hdHVyZSk7XG4gICAgY2FzZSBTaWduaW5nU2NoZW1lMi5TaW5nbGVLZXk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFueVNpZ25hdHVyZSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBzaWduaW5nIHNjaGVtZTogJHtzaWduaW5nU2NoZW1lfWApO1xuICB9XG59XG5cbi8vIHNyYy9zaGFyZWQvVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQudHNcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzNSxcbiAgZGVzZXJpYWxpemVGcm9tU2NyaXB0QXJndW1lbnQsXG4gIEhleCxcbiAgcGFyc2VUeXBlVGFnLFxuICBUeXBlVGFnXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQgPSAvKiBAX19QVVJFX18gKi8gKChUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyKSA9PiB7XG4gIFRyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudDJbVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50MltcIkVudHJ5RnVuY3Rpb25cIl0gPSAwXSA9IFwiRW50cnlGdW5jdGlvblwiO1xuICBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyW1RyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudDJbXCJTY3JpcHRcIl0gPSAxXSA9IFwiU2NyaXB0XCI7XG4gIFRyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudDJbVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50MltcIk11bHRpc2lnXCJdID0gMl0gPSBcIk11bHRpc2lnXCI7XG4gIHJldHVybiBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyO1xufSkoVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50IHx8IHt9KTtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoc2VyaWFsaXplciwgdHlwZUFyZ3VtZW50cykge1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh0eXBlQXJndW1lbnRzLmxlbmd0aCk7XG4gIGZvciAoY29uc3QgdHlwZUFyZ3VtZW50IG9mIHR5cGVBcmd1bWVudHMpIHtcbiAgICBjb25zdCB0eXBlVGFnID0gdHlwZW9mIHR5cGVBcmd1bWVudCA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlVHlwZVRhZyh0eXBlQXJndW1lbnQsIHsgYWxsb3dHZW5lcmljczogdHJ1ZSB9KSA6IHR5cGVBcmd1bWVudDtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh0eXBlVGFnKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVUeXBlQXJndW1lbnRzKGRlc2VyaWFsaXplcikge1xuICBjb25zdCB0eXBlQXJndW1lbnRzID0gW107XG4gIGNvbnN0IHR5cGVBcmd1bWVudHNMZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eXBlQXJndW1lbnRzTGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25zdCB0eXBlVGFnID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKFR5cGVUYWcpO1xuICAgIHR5cGVBcmd1bWVudHMucHVzaCh0eXBlVGFnKTtcbiAgfVxuICByZXR1cm4gdHlwZUFyZ3VtZW50cztcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoc2VyaWFsaXplciwgZnVuY3Rpb25Bcmd1bWVudHMpIHtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoZnVuY3Rpb25Bcmd1bWVudHMubGVuZ3RoKTtcbiAgZm9yIChjb25zdCBmdW5jdGlvbkFyZ3VtZW50IG9mIGZ1bmN0aW9uQXJndW1lbnRzKSB7XG4gICAgc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50KHNlcmlhbGl6ZXIsIGZ1bmN0aW9uQXJndW1lbnQpO1xuICB9XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoZGVzZXJpYWxpemVyKSB7XG4gIGNvbnN0IGZ1bmN0aW9uQXJndW1lbnRzTGVuZ3RoID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gIGNvbnN0IGZ1bmN0aW9uQXJndW1lbnRzID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZnVuY3Rpb25Bcmd1bWVudHNMZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IGZ1bmN0aW9uQXJndW1lbnQgPSBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudChkZXNlcmlhbGl6ZXIpO1xuICAgIGZ1bmN0aW9uQXJndW1lbnRzLnB1c2goZnVuY3Rpb25Bcmd1bWVudCk7XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uQXJndW1lbnRzO1xufVxuZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQoc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgaWYgKFwibXVsdGlzaWdBZGRyZXNzXCIgaW4gdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgyIC8qIE11bHRpc2lnICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5mdW5jdGlvbik7XG4gICAgc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50cyhzZXJpYWxpemVyLCB2YWx1ZS5mdW5jdGlvbkFyZ3VtZW50cyk7XG4gICAgc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhzZXJpYWxpemVyLCB2YWx1ZS50eXBlQXJndW1lbnRzID8/IFtdKTtcbiAgICBjb25zdCBtdWx0aXNpZ0FkZHJlc3MgPSBBY2NvdW50QWRkcmVzczUuZnJvbSh2YWx1ZS5tdWx0aXNpZ0FkZHJlc3MpO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKG11bHRpc2lnQWRkcmVzcyk7XG4gIH0gZWxzZSBpZiAoXCJmdW5jdGlvblwiIGluIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMCAvKiBFbnRyeUZ1bmN0aW9uICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5mdW5jdGlvbik7XG4gICAgc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50cyhzZXJpYWxpemVyLCB2YWx1ZS5mdW5jdGlvbkFyZ3VtZW50cyk7XG4gICAgc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhzZXJpYWxpemVyLCB2YWx1ZS50eXBlQXJndW1lbnRzID8/IFtdKTtcbiAgfSBlbHNlIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgxIC8qIFNjcmlwdCAqLyk7XG4gICAgY29uc3QgYnl0ZWNvZGUgPSBIZXguZnJvbUhleElucHV0KHZhbHVlLmJ5dGVjb2RlKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKGJ5dGVjb2RlLnRvVWludDhBcnJheSgpKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5mdW5jdGlvbkFyZ3VtZW50cy5sZW5ndGgpO1xuICAgIGZvciAoY29uc3QgYXJndW1lbnQgb2YgdmFsdWUuZnVuY3Rpb25Bcmd1bWVudHMpIHtcbiAgICAgIGFyZ3VtZW50LnNlcmlhbGl6ZUZvclNjcmlwdEZ1bmN0aW9uKHNlcmlhbGl6ZXIpO1xuICAgIH1cbiAgICBzZXJpYWxpemVUeXBlQXJndW1lbnRzKHNlcmlhbGl6ZXIsIHZhbHVlLnR5cGVBcmd1bWVudHMgPz8gW10pO1xuICB9XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0KGRlc2VyaWFsaXplcikge1xuICBjb25zdCB2YXJpYW50ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gIHN3aXRjaCAodmFyaWFudCkge1xuICAgIGNhc2UgMiAvKiBNdWx0aXNpZyAqLzoge1xuICAgICAgY29uc3QgZnVuY3Rpb25JZCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpO1xuICAgICAgY29uc3QgZnVuY3Rpb25Bcmd1bWVudHMgPSBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoZGVzZXJpYWxpemVyKTtcbiAgICAgIGNvbnN0IHR5cGVBcmd1bWVudHMgPSBkZXNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoZGVzZXJpYWxpemVyKTtcbiAgICAgIGNvbnN0IG11bHRpc2lnQWRkcmVzcyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZnVuY3Rpb246IGZ1bmN0aW9uSWQsXG4gICAgICAgIGZ1bmN0aW9uQXJndW1lbnRzLFxuICAgICAgICBtdWx0aXNpZ0FkZHJlc3MsXG4gICAgICAgIHR5cGVBcmd1bWVudHNcbiAgICAgIH07XG4gICAgfVxuICAgIGNhc2UgMCAvKiBFbnRyeUZ1bmN0aW9uICovOiB7XG4gICAgICBjb25zdCBmdW5jdGlvbklkID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCk7XG4gICAgICBjb25zdCBmdW5jdGlvbkFyZ3VtZW50cyA9IGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50cyhkZXNlcmlhbGl6ZXIpO1xuICAgICAgY29uc3QgdHlwZUFyZ3VtZW50cyA9IGRlc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhkZXNlcmlhbGl6ZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZnVuY3Rpb246IGZ1bmN0aW9uSWQsXG4gICAgICAgIGZ1bmN0aW9uQXJndW1lbnRzLFxuICAgICAgICB0eXBlQXJndW1lbnRzXG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlIDEgLyogU2NyaXB0ICovOiB7XG4gICAgICBjb25zdCBieXRlY29kZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gICAgICBjb25zdCBmdW5jdGlvbkFyZ3VtZW50c0xlbmd0aCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgICAgY29uc3QgZnVuY3Rpb25Bcmd1bWVudHMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZnVuY3Rpb25Bcmd1bWVudHNMZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBhcmd1bWVudCA9IGRlc2VyaWFsaXplRnJvbVNjcmlwdEFyZ3VtZW50KGRlc2VyaWFsaXplcik7XG4gICAgICAgIGZ1bmN0aW9uQXJndW1lbnRzLnB1c2goYXJndW1lbnQpO1xuICAgICAgfVxuICAgICAgY29uc3QgdHlwZUFyZ3VtZW50cyA9IGRlc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhkZXNlcmlhbGl6ZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnl0ZWNvZGUsXG4gICAgICAgIGZ1bmN0aW9uQXJndW1lbnRzLFxuICAgICAgICB0eXBlQXJndW1lbnRzXG4gICAgICB9O1xuICAgIH1cbiAgICBkZWZhdWx0OiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIHZhcmlhbnRcIik7XG4gICAgfVxuICB9XG59XG5cbi8vIHNyYy9XYWxsZXRSZXF1ZXN0LnRzXG5mdW5jdGlvbiBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0KHtcbiAgZGFwcEluZm8sXG4gIG5hbWUsXG4gIHZlcnNpb25cbn0pIHtcbiAgY29uc3Qgc2VyaWFsaXplciA9IG5ldyBTZXJpYWxpemVyOSgpO1xuICBzZXJpYWxpemVEYXBwSW5mbyhzZXJpYWxpemVyLCBkYXBwSW5mbyk7XG4gIGNvbnN0IGRhdGEgPSBzZXJpYWxpemVyLnRvVWludDhBcnJheSgpO1xuICByZXR1cm4geyBkYXRhLCBuYW1lLCB2ZXJzaW9uIH07XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3Qoe1xuICBkYXRhLFxuICBuYW1lLFxuICB2ZXJzaW9uXG59KSB7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXI5KGRhdGEpO1xuICBjb25zdCBkYXBwSW5mbyA9IGRlc2VyaWFsaXplRGFwcEluZm8oZGVzZXJpYWxpemVyKTtcbiAgcmV0dXJuIHsgZGFwcEluZm8sIG5hbWUsIHZlcnNpb24gfTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyh7IGFyZ3MsIGRhcHBJbmZvLCBuYW1lLCB2ZXJzaW9uIH0sIHNlcmlhbGl6ZUFyZ3NGbikge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXI5KCk7XG4gIHNlcmlhbGl6ZURhcHBJbmZvKHNlcmlhbGl6ZXIsIGRhcHBJbmZvKTtcbiAgc2VyaWFsaXplQXJnc0ZuKHNlcmlhbGl6ZXIsIGFyZ3MpO1xuICBjb25zdCBkYXRhID0gc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKTtcbiAgcmV0dXJuIHsgZGF0YSwgbmFtZSwgdmVyc2lvbiB9O1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MoeyBkYXRhLCBuYW1lLCB2ZXJzaW9uIH0sIGRlc2VyaWFsaXplQXJnc0ZuKSB7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXI5KGRhdGEpO1xuICBjb25zdCBkYXBwSW5mbyA9IGRlc2VyaWFsaXplRGFwcEluZm8oZGVzZXJpYWxpemVyKTtcbiAgY29uc3QgYXJncyA9IGRlc2VyaWFsaXplQXJnc0ZuKGRlc2VyaWFsaXplcik7XG4gIHJldHVybiB7IGFyZ3MsIGRhcHBJbmZvLCBuYW1lLCB2ZXJzaW9uIH07XG59XG5cbi8vIHNyYy9mZWF0dXJlcy9jb25uZWN0L3JlcXVlc3QudHNcbnZhciBDb25uZWN0UmVxdWVzdDtcbigoQ29ubmVjdFJlcXVlc3QyKSA9PiB7XG4gIENvbm5lY3RSZXF1ZXN0Mi5uYW1lID0gXCJjb25uZWN0XCI7XG4gIENvbm5lY3RSZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucyA9IFsxLCAyLCAzLCA0XTtcbiAgQ29ubmVjdFJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uID0gNDtcbiAgZnVuY3Rpb24gc2VyaWFsaXplQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplT3B0aW9uU3RyKHZhbHVlLmRhcHBJZCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVPcHRpb25TdHIodmFsdWUuZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplT3B0aW9uU3RyKHZhbHVlLnByZWZlcnJlZFdhbGxldE5hbWUpO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZS5jbGFpbU9wdGlvbnMgIT09IHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlLmNsYWltT3B0aW9ucykge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuY2xhaW1PcHRpb25zLnNlY3JldEtleSk7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5jbGFpbU9wdGlvbnMubmV0d29yayk7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZU9wdGlvblN0cih2YWx1ZS5jbGFpbU9wdGlvbnMuYXNzZXQpO1xuICAgICAgaWYgKCFpc1N1cHBvcnRlZE5ldHdvcmsodmFsdWUuY2xhaW1PcHRpb25zLm5ldHdvcmspKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgbmV0d29yayAnJHt2YWx1ZS5jbGFpbU9wdGlvbnMubmV0d29ya30nYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemVBcmdzID0gc2VyaWFsaXplQXJncztcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplciwgdmVyc2lvbikge1xuICAgIGlmICh2ZXJzaW9uID09PSAxKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGNvbnN0IGRhcHBJZCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZU9wdGlvblN0cigpO1xuICAgIGNvbnN0IGRhcHBFZDI1NTE5UHVibGljS2V5QjY0ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgY29uc3QgcHJlZmVycmVkV2FsbGV0TmFtZSA9IHZlcnNpb24gPj0gMyA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZU9wdGlvblN0cigpIDogdm9pZCAwO1xuICAgIGNvbnN0IGhhc0NsYWltT3B0aW9ucyA9IHZlcnNpb24gPj0gNCA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKSA6IGZhbHNlO1xuICAgIGxldCBjbGFpbU9wdGlvbnM7XG4gICAgaWYgKGhhc0NsYWltT3B0aW9ucykge1xuICAgICAgY29uc3Qgc2VjcmV0S2V5ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEVkMjU1MTlQcml2YXRlS2V5KTtcbiAgICAgIGNvbnN0IG5ldHdvcmsgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgICAgIGNvbnN0IGFzc2V0ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgICBpZiAoIWlzU3VwcG9ydGVkTmV0d29yayhuZXR3b3JrKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG5ldHdvcmsgJyR7bmV0d29ya30nYCk7XG4gICAgICB9XG4gICAgICBjbGFpbU9wdGlvbnMgPSB7IGFzc2V0LCBuZXR3b3JrLCBzZWNyZXRLZXkgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgY2xhaW1PcHRpb25zLCBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCwgZGFwcElkLCBwcmVmZXJyZWRXYWxsZXROYW1lIH07XG4gIH1cbiAgQ29ubmVjdFJlcXVlc3QyLmRlc2VyaWFsaXplQXJncyA9IGRlc2VyaWFsaXplQXJncztcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvLCBhcmdzID0ge30pIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKHsgYXJncywgZGFwcEluZm8sIG5hbWU6IENvbm5lY3RSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBDb25uZWN0UmVxdWVzdDIuY3VycmVudFZlcnNpb24gfSwgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgQ29ubmVjdFJlcXVlc3QyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUocmVxdWVzdCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhyZXF1ZXN0LCAoZCkgPT4gZGVzZXJpYWxpemVBcmdzKGQsIHJlcXVlc3QudmVyc2lvbikpO1xuICB9XG4gIENvbm5lY3RSZXF1ZXN0Mi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xuICBmdW5jdGlvbiBpc1NlcmlhbGl6ZWQocmVxdWVzdCkge1xuICAgIHJldHVybiByZXF1ZXN0Lm5hbWUgPT09IENvbm5lY3RSZXF1ZXN0Mi5uYW1lICYmIENvbm5lY3RSZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucy5pbmNsdWRlcyhyZXF1ZXN0LnZlcnNpb24pO1xuICB9XG4gIENvbm5lY3RSZXF1ZXN0Mi5pc1NlcmlhbGl6ZWQgPSBpc1NlcmlhbGl6ZWQ7XG59KShDb25uZWN0UmVxdWVzdCB8fCAoQ29ubmVjdFJlcXVlc3QgPSB7fSkpO1xuXG4vLyBzcmMvVXNlclJlc3BvbnNlLnRzXG5mdW5jdGlvbiBtYWtlVXNlckFwcHJvdmFsKGFyZ3MpIHtcbiAgcmV0dXJuIHsgYXJncywgc3RhdHVzOiBcImFwcHJvdmVkXCIgfTtcbn1cbmZ1bmN0aW9uIG1ha2VVc2VyUmVzcG9uc2VTZXJpYWxpemVGbihzZXJpYWxpemVBcmdzKSB7XG4gIHJldHVybiAoc2VyaWFsaXplciwgdmFsdWUpID0+IHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUuc3RhdHVzID09PSBcImFwcHJvdmVkXCIpO1xuICAgIGlmICh2YWx1ZS5zdGF0dXMgPT09IFwiYXBwcm92ZWRcIikge1xuICAgICAgc2VyaWFsaXplQXJncyhzZXJpYWxpemVyLCB2YWx1ZS5hcmdzKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBtYWtlVXNlclJlc3BvbnNlRGVzZXJpYWxpemVGbihkZXNlcmlhbGl6ZUFyZ3MpIHtcbiAgcmV0dXJuIChkZXNlcmlhbGl6ZXIpID0+IHtcbiAgICBjb25zdCBpc0FwcHJvdmVkID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIHJldHVybiBpc0FwcHJvdmVkID8geyBhcmdzOiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyKSwgc3RhdHVzOiBcImFwcHJvdmVkXCIgfSA6IHsgc3RhdHVzOiBcImRpc21pc3NlZFwiIH07XG4gIH07XG59XG5cbi8vIHNyYy9XYWxsZXRSZXNwb25zZS50c1xuaW1wb3J0IHsgRGVzZXJpYWxpemVyIGFzIERlc2VyaWFsaXplcjExLCBTZXJpYWxpemVyIGFzIFNlcmlhbGl6ZXIxMSB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsIHNlcmlhbGl6ZUZuKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcjExKCk7XG4gIHNlcmlhbGl6ZUZuKHNlcmlhbGl6ZXIsIGFyZ3MpO1xuICBjb25zdCBkYXRhID0gc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKTtcbiAgcmV0dXJuIHsgZGF0YSB9O1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZSh7IGRhdGEgfSwgZGVzZXJpYWxpemVGbikge1xuICBjb25zdCBkZXNlcmlhbGl6ZXIgPSBuZXcgRGVzZXJpYWxpemVyMTEoZGF0YSk7XG4gIGNvbnN0IGFyZ3MgPSBkZXNlcmlhbGl6ZUZuKGRlc2VyaWFsaXplcik7XG4gIHJldHVybiB7IGFyZ3MgfTtcbn1cblxuLy8gc3JjL2ZlYXR1cmVzL2Nvbm5lY3QvcmVzcG9uc2UudHNcbnZhciBDb25uZWN0UmVzcG9uc2U7XG4oKENvbm5lY3RSZXNwb25zZTIpID0+IHtcbiAgQ29ubmVjdFJlc3BvbnNlMi5zdXBwb3J0ZWRWZXJzaW9ucyA9IFsxLCAyXTtcbiAgQ29ubmVjdFJlc3BvbnNlMi5jdXJyZW50VmVyc2lvbiA9IDI7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFwcHJvdmFsQXJnc1YxKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplQWNjb3VudEluZm8oc2VyaWFsaXplciwgdmFsdWUuYWNjb3VudCk7XG4gIH1cbiAgZnVuY3Rpb24gc2VyaWFsaXplQXBwcm92YWxBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplQWNjb3VudEluZm8oc2VyaWFsaXplciwgdmFsdWUuYWNjb3VudCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVPcHRpb25TdHIodmFsdWUucGFpcmluZyAhPT0gdm9pZCAwID8gSlNPTi5zdHJpbmdpZnkodmFsdWUucGFpcmluZykgOiB2b2lkIDApO1xuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKGRlc2VyaWFsaXplcikge1xuICAgIGNvbnN0IGFjY291bnQgPSBkZXNlcmlhbGl6ZUFjY291bnRJbmZvKGRlc2VyaWFsaXplcik7XG4gICAgY29uc3Qgc2VyaWFsaXplZFBhaXJpbmcgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVPcHRpb25TdHIoKTtcbiAgICBjb25zdCBwYWlyaW5nID0gc2VyaWFsaXplZFBhaXJpbmcgIT09IHZvaWQgMCA/IEpTT04ucGFyc2Uoc2VyaWFsaXplZFBhaXJpbmcpIDogdm9pZCAwO1xuICAgIHJldHVybiB7IGFjY291bnQsIHBhaXJpbmcgfTtcbiAgfVxuICBjb25zdCBzZXJpYWxpemVBcmdzVjEgPSBtYWtlVXNlclJlc3BvbnNlU2VyaWFsaXplRm4oc2VyaWFsaXplQXBwcm92YWxBcmdzVjEpO1xuICBjb25zdCBzZXJpYWxpemVBcmdzID0gbWFrZVVzZXJSZXNwb25zZVNlcmlhbGl6ZUZuKHNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGNvbnN0IGRlc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VEZXNlcmlhbGl6ZUZuKGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MsIHZlcnNpb24gPSBDb25uZWN0UmVzcG9uc2UyLmN1cnJlbnRWZXJzaW9uKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsIHZlcnNpb24gPT09IDEgPyBzZXJpYWxpemVBcmdzVjEgOiBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBDb25uZWN0UmVzcG9uc2UyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2Uoc2VyaWFsaXplZFJlc3BvbnNlLCBkZXNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIENvbm5lY3RSZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKENvbm5lY3RSZXNwb25zZSB8fCAoQ29ubmVjdFJlc3BvbnNlID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2Rpc2Nvbm5lY3QvcmVxdWVzdC50c1xudmFyIERpc2Nvbm5lY3RSZXF1ZXN0O1xuKChEaXNjb25uZWN0UmVxdWVzdDIpID0+IHtcbiAgRGlzY29ubmVjdFJlcXVlc3QyLm5hbWUgPSBcImRpc2Nvbm5lY3RcIjtcbiAgRGlzY29ubmVjdFJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uID0gMTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3QoeyBkYXBwSW5mbywgbmFtZTogRGlzY29ubmVjdFJlcXVlc3QyLm5hbWUsIHZlcnNpb246IERpc2Nvbm5lY3RSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiB9KTtcbiAgfVxuICBEaXNjb25uZWN0UmVxdWVzdDIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdChyZXF1ZXN0KTtcbiAgfVxuICBEaXNjb25uZWN0UmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBEaXNjb25uZWN0UmVxdWVzdDIubmFtZSAmJiByZXF1ZXN0LnZlcnNpb24gPT09IERpc2Nvbm5lY3RSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbjtcbiAgfVxuICBEaXNjb25uZWN0UmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoRGlzY29ubmVjdFJlcXVlc3QgfHwgKERpc2Nvbm5lY3RSZXF1ZXN0ID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2Rpc2Nvbm5lY3QvcmVzcG9uc2UudHNcbnZhciBEaXNjb25uZWN0UmVzcG9uc2U7XG4oKERpc2Nvbm5lY3RSZXNwb25zZTIpID0+IHtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MpIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoYXJncywgKCkgPT4ge1xuICAgIH0pO1xuICB9XG4gIERpc2Nvbm5lY3RSZXNwb25zZTIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZShzZXJpYWxpemVkUmVzcG9uc2UsICgpID0+ICh7fSkpO1xuICB9XG4gIERpc2Nvbm5lY3RSZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKERpc2Nvbm5lY3RSZXNwb25zZSB8fCAoRGlzY29ubmVjdFJlc3BvbnNlID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2dldENvbm5lY3RlZEFjY291bnRzL3JlcXVlc3QudHNcbnZhciBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3Q7XG4oKEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIpID0+IHtcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5uYW1lID0gXCJnZXRDb25uZWN0ZWRBY2NvdW50c1wiO1xuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLmN1cnJlbnRWZXJzaW9uID0gMTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3QoeyBkYXBwSW5mbywgbmFtZTogR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLmN1cnJlbnRWZXJzaW9uIH0pO1xuICB9XG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdChyZXF1ZXN0KTtcbiAgfVxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGlzU2VyaWFsaXplZChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHJlcXVlc3QubmFtZSA9PT0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5uYW1lICYmIHJlcXVlc3QudmVyc2lvbiA9PT0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbjtcbiAgfVxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLmlzU2VyaWFsaXplZCA9IGlzU2VyaWFsaXplZDtcbn0pKEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdCB8fCAoR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0ID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2dldENvbm5lY3RlZEFjY291bnRzL3Jlc3BvbnNlLnRzXG52YXIgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTtcbigoR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIpID0+IHtcbiAgZnVuY3Rpb24gc2VyaWFsaXplQXJncyhzZXJpYWxpemVyLCBhcmdzKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoYXJncy5sZW5ndGgpO1xuICAgIGZvciAoY29uc3QgYWNjb3VudCBvZiBhcmdzKSB7XG4gICAgICBzZXJpYWxpemVBY2NvdW50SW5mbyhzZXJpYWxpemVyLCBhY2NvdW50KTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplcikge1xuICAgIGNvbnN0IGxlbmd0aCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IGFjY291bnRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgYWNjb3VudHMucHVzaChkZXNlcmlhbGl6ZUFjY291bnRJbmZvKGRlc2VyaWFsaXplcikpO1xuICAgIH1cbiAgICByZXR1cm4gYWNjb3VudHM7XG4gIH1cbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MpIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoYXJncywgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZShzZXJpYWxpemVkUmVzcG9uc2UsIGRlc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UgfHwgKEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvaXNDb25uZWN0ZWQvcmVxdWVzdC50c1xudmFyIElzQ29ubmVjdGVkUmVxdWVzdDtcbigoSXNDb25uZWN0ZWRSZXF1ZXN0MikgPT4ge1xuICBJc0Nvbm5lY3RlZFJlcXVlc3QyLm5hbWUgPSBcImlzQ29ubmVjdGVkXCI7XG4gIElzQ29ubmVjdGVkUmVxdWVzdDIuY3VycmVudFZlcnNpb24gPSAxO1xuICBmdW5jdGlvbiBzZXJpYWxpemUoZGFwcEluZm8pIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVxdWVzdCh7IGRhcHBJbmZvLCBuYW1lOiBJc0Nvbm5lY3RlZFJlcXVlc3QyLm5hbWUsIHZlcnNpb246IElzQ29ubmVjdGVkUmVxdWVzdDIuY3VycmVudFZlcnNpb24gfSk7XG4gIH1cbiAgSXNDb25uZWN0ZWRSZXF1ZXN0Mi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0KHJlcXVlc3QpO1xuICB9XG4gIElzQ29ubmVjdGVkUmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBJc0Nvbm5lY3RlZFJlcXVlc3QyLm5hbWUgJiYgcmVxdWVzdC52ZXJzaW9uID09PSBJc0Nvbm5lY3RlZFJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uO1xuICB9XG4gIElzQ29ubmVjdGVkUmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoSXNDb25uZWN0ZWRSZXF1ZXN0IHx8IChJc0Nvbm5lY3RlZFJlcXVlc3QgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvaXNDb25uZWN0ZWQvcmVzcG9uc2UudHNcbnZhciBJc0Nvbm5lY3RlZFJlc3BvbnNlO1xuKChJc0Nvbm5lY3RlZFJlc3BvbnNlMikgPT4ge1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlKTtcbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgfVxuICBmdW5jdGlvbiBzZXJpYWxpemUoYXJncykge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXNwb25zZShhcmdzLCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBJc0Nvbm5lY3RlZFJlc3BvbnNlMi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKHNlcmlhbGl6ZWRSZXNwb25zZSwgZGVzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBJc0Nvbm5lY3RlZFJlc3BvbnNlMi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xufSkoSXNDb25uZWN0ZWRSZXNwb25zZSB8fCAoSXNDb25uZWN0ZWRSZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduQW5kU3VibWl0VHJhbnNhY3Rpb24vcmVxdWVzdC50c1xuaW1wb3J0IHtcbiAgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3M2LFxuICBUcmFuc2FjdGlvblBheWxvYWRcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xudmFyIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3Q7XG4oKFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyKSA9PiB7XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLm5hbWUgPSBcInNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblwiO1xuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucyA9IFsxLCAyLCAzXTtcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIuY3VycmVudFZlcnNpb24gPSAzO1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlLm5ldHdvcmsgIT09IHZvaWQgMCAmJiAhaXNTdXBwb3J0ZWROZXR3b3JrKHZhbHVlLm5ldHdvcmspKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG5ldHdvcmsgJyR7dmFsdWUubmV0d29ya30nYCk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZS5zaWduZXJBZGRyZXNzICE9PSB2b2lkIDApO1xuICAgIGlmICh2YWx1ZS5zaWduZXJBZGRyZXNzICE9PSB2b2lkIDApIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLnNpZ25lckFkZHJlc3MpO1xuICAgIH1cbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZU9wdGlvblN0cih2YWx1ZS5uZXR3b3JrKTtcbiAgICBpZiAoXCJiY3NUb0J5dGVzXCIgaW4gdmFsdWUucGF5bG9hZCkge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHRydWUpO1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUucGF5bG9hZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbChmYWxzZSk7XG4gICAgICBzZXJpYWxpemVUcmFuc2FjdGlvblBheWxvYWRJbnB1dChzZXJpYWxpemVyLCB2YWx1ZS5wYXlsb2FkKTtcbiAgICB9XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVNjQodmFsdWUuZXhwaXJhdGlvblRpbWVzdGFtcCA/PyAwKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5nYXNVbml0UHJpY2UgPz8gMCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgodmFsdWUubWF4R2FzQW1vdW50ID8/IDApO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KHZhbHVlLmZlZVBheWVyID8gMSA6IDApO1xuICAgIGlmICh2YWx1ZS5mZWVQYXllcikge1xuICAgICAgc2VyaWFsaXplQWNjb3VudEF1dGhlbnRpY2F0b3JJbnB1dChzZXJpYWxpemVyLCB2YWx1ZS5mZWVQYXllcik7XG4gICAgfVxuICB9XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLnNlcmlhbGl6ZUFyZ3MgPSBzZXJpYWxpemVBcmdzO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyLCB2ZXJzaW9uKSB7XG4gICAgY29uc3QgaGFzU2lnbmVyQWRkcmVzcyA9IHZlcnNpb24gPj0gMyAmJiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gICAgY29uc3Qgc2lnbmVyQWRkcmVzcyA9IGhhc1NpZ25lckFkZHJlc3MgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEFkZHJlc3M2KSA6IHZvaWQgMDtcbiAgICBjb25zdCBuZXR3b3JrID0gdmVyc2lvbiA9PT0gMSA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpIDogZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgaWYgKG5ldHdvcmsgIT09IHZvaWQgMCAmJiAhaXNTdXBwb3J0ZWROZXR3b3JrKG5ldHdvcmspKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG5ldHdvcmsgJyR7bmV0d29ya30nYCk7XG4gICAgfVxuICAgIGNvbnN0IGlzUGF5bG9hZEJjc1NlcmlhbGl6YWJsZSA9IHZlcnNpb24gPT09IDEgfHwgZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IHBheWxvYWQgPSBpc1BheWxvYWRCY3NTZXJpYWxpemFibGUgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoVHJhbnNhY3Rpb25QYXlsb2FkKSA6IGRlc2VyaWFsaXplVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQoZGVzZXJpYWxpemVyKTtcbiAgICBjb25zdCBleHBpcmF0aW9uVGltZXN0YW1wID0gTnVtYmVyKGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVU2NCgpKTtcbiAgICBjb25zdCBnYXNVbml0UHJpY2UgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICBjb25zdCBtYXhHYXNBbW91bnQgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICBjb25zdCBoYXNGZWVQYXllciA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IGZlZVBheWVyID0gaGFzRmVlUGF5ZXIgPyBkZXNlcmlhbGl6ZUFjY291bnRBdXRoZW50aWNhdG9ySW5wdXQoZGVzZXJpYWxpemVyKSA6IHZvaWQgMDtcbiAgICByZXR1cm4ge1xuICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcDogZXhwaXJhdGlvblRpbWVzdGFtcCA+IDAgPyBleHBpcmF0aW9uVGltZXN0YW1wIDogdm9pZCAwLFxuICAgICAgZmVlUGF5ZXIsXG4gICAgICBnYXNVbml0UHJpY2U6IGdhc1VuaXRQcmljZSA+IDAgPyBnYXNVbml0UHJpY2UgOiB2b2lkIDAsXG4gICAgICBtYXhHYXNBbW91bnQ6IG1heEdhc0Ftb3VudCA+IDAgPyBtYXhHYXNBbW91bnQgOiB2b2lkIDAsXG4gICAgICBuZXR3b3JrLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIHNpZ25lckFkZHJlc3NcbiAgICB9O1xuICB9XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLmRlc2VyaWFsaXplQXJncyA9IGRlc2VyaWFsaXplQXJncztcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvLCBhcmdzKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHsgYXJncywgZGFwcEluZm8sIG5hbWU6IFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLm5hbWUsIHZlcnNpb246IFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uIH07XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhyZXF1ZXN0LCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKFxuICAgICAgc2VyaWFsaXplZFJlcXVlc3QsXG4gICAgICAoZGVzZXJpYWxpemVyKSA9PiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyLCBzZXJpYWxpemVkUmVxdWVzdC52ZXJzaW9uKVxuICAgICk7XG4gIH1cbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5uYW1lICYmIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLnN1cHBvcnRlZFZlcnNpb25zLmluY2x1ZGVzKHJlcXVlc3QudmVyc2lvbik7XG4gIH1cbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCB8fCAoU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduQW5kU3VibWl0VHJhbnNhY3Rpb24vcmVzcG9uc2UudHNcbnZhciBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZTtcbigoU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyKSA9PiB7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFwcHJvdmFsQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLnR4bkhhc2gpO1xuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKGRlc2VyaWFsaXplcikge1xuICAgIGNvbnN0IHR4bkhhc2ggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgICByZXR1cm4geyB0eG5IYXNoIH07XG4gIH1cbiAgY29uc3Qgc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VTZXJpYWxpemVGbihzZXJpYWxpemVBcHByb3ZhbEFyZ3MpO1xuICBjb25zdCBkZXNlcmlhbGl6ZUFyZ3MgPSBtYWtlVXNlclJlc3BvbnNlRGVzZXJpYWxpemVGbihkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShhcmdzKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlMi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKHNlcmlhbGl6ZWRSZXNwb25zZSwgZGVzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlIHx8IChTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduTWVzc2FnZS9yZXF1ZXN0LnRzXG5pbXBvcnQgeyBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczcgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgU2lnbk1lc3NhZ2VSZXF1ZXN0O1xuKChTaWduTWVzc2FnZVJlcXVlc3QyKSA9PiB7XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIubmFtZSA9IFwic2lnbk1lc3NhZ2VcIjtcbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucyA9IFsxLCAyXTtcbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiA9IDI7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUuc2lnbmVyQWRkcmVzcyAhPT0gdm9pZCAwKTtcbiAgICBpZiAodmFsdWUuc2lnbmVyQWRkcmVzcyAhPT0gdm9pZCAwKSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5zaWduZXJBZGRyZXNzKTtcbiAgICB9XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVOCh2YWx1ZS5jaGFpbklkKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKHZhbHVlLm5vbmNlKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKHZhbHVlLm1lc3NhZ2UpO1xuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXJncyhkZXNlcmlhbGl6ZXIsIHZlcnNpb24pIHtcbiAgICBjb25zdCBoYXNTaWduZXJBZGRyZXNzID0gdmVyc2lvbiA+PSAyICYmIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCBzaWduZXJBZGRyZXNzID0gaGFzU2lnbmVyQWRkcmVzcyA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczcpIDogdm9pZCAwO1xuICAgIGNvbnN0IGNoYWluSWQgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVOCgpO1xuICAgIGNvbnN0IG5vbmNlID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQnl0ZXMoKTtcbiAgICBjb25zdCBtZXNzYWdlID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQnl0ZXMoKTtcbiAgICByZXR1cm4geyBjaGFpbklkLCBtZXNzYWdlLCBub25jZSwgc2lnbmVyQWRkcmVzcyB9O1xuICB9XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShkYXBwSW5mbywgYXJncykge1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7IGFyZ3MsIGRhcHBJbmZvLCBuYW1lOiBTaWduTWVzc2FnZVJlcXVlc3QyLm5hbWUsIHZlcnNpb246IFNpZ25NZXNzYWdlUmVxdWVzdDIuY3VycmVudFZlcnNpb24gfTtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKHJlcXVlc3QsIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVxdWVzdCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhzZXJpYWxpemVkUmVxdWVzdCwgKGQpID0+IGRlc2VyaWFsaXplQXJncyhkLCBzZXJpYWxpemVkUmVxdWVzdC52ZXJzaW9uKSk7XG4gIH1cbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0Mi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xuICBmdW5jdGlvbiBpc1NlcmlhbGl6ZWQocmVxdWVzdCkge1xuICAgIHJldHVybiByZXF1ZXN0Lm5hbWUgPT09IFNpZ25NZXNzYWdlUmVxdWVzdDIubmFtZSAmJiByZXF1ZXN0LnZlcnNpb24gPT09IFNpZ25NZXNzYWdlUmVxdWVzdDIuY3VycmVudFZlcnNpb247XG4gIH1cbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0Mi5pc1NlcmlhbGl6ZWQgPSBpc1NlcmlhbGl6ZWQ7XG59KShTaWduTWVzc2FnZVJlcXVlc3QgfHwgKFNpZ25NZXNzYWdlUmVxdWVzdCA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduTWVzc2FnZS9yZXNwb25zZS50c1xudmFyIFNpZ25NZXNzYWdlUmVzcG9uc2U7XG4oKFNpZ25NZXNzYWdlUmVzcG9uc2UyKSA9PiB7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFwcHJvdmFsQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLmZ1bGxNZXNzYWdlKTtcbiAgICBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgdmFsdWUuc2lnbmF0dXJlKTtcbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyhkZXNlcmlhbGl6ZXIpIHtcbiAgICBjb25zdCBmdWxsTWVzc2FnZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcik7XG4gICAgcmV0dXJuIHsgZnVsbE1lc3NhZ2UsIHNpZ25hdHVyZSB9O1xuICB9XG4gIGNvbnN0IHNlcmlhbGl6ZUFyZ3MgPSBtYWtlVXNlclJlc3BvbnNlU2VyaWFsaXplRm4oc2VyaWFsaXplQXBwcm92YWxBcmdzKTtcbiAgY29uc3QgZGVzZXJpYWxpemVBcmdzID0gbWFrZVVzZXJSZXNwb25zZURlc2VyaWFsaXplRm4oZGVzZXJpYWxpemVBcHByb3ZhbEFyZ3MpO1xuICBmdW5jdGlvbiBzZXJpYWxpemUoYXJncykge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXNwb25zZShhcmdzLCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduTWVzc2FnZVJlc3BvbnNlMi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKHNlcmlhbGl6ZWRSZXNwb25zZSwgZGVzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduTWVzc2FnZVJlc3BvbnNlMi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xufSkoU2lnbk1lc3NhZ2VSZXNwb25zZSB8fCAoU2lnbk1lc3NhZ2VSZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduVHJhbnNhY3Rpb24vcmVxdWVzdC50c1xuaW1wb3J0IHtcbiAgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3M4LFxuICBUcmFuc2FjdGlvblBheWxvYWQgYXMgVHJhbnNhY3Rpb25QYXlsb2FkMlxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDtcbigoU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIpID0+IHtcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubmFtZSA9IFwic2lnblRyYW5zYWN0aW9uXCI7XG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLnN1cHBvcnRlZFZlcnNpb25zID0gWzEsIDIsIDMsIDRdO1xuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiA9IDQ7XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZUFyZ3MoYXJncykge1xuICAgIGNvbnN0IHsgZmVlUGF5ZXIsIHNlY29uZGFyeVNpZ25lcnMsIHNlbmRlclB1YmxpY0tleSwgc2lnbmVyQWRkcmVzcywgdHJhbnNhY3Rpb24gfSA9IGFyZ3M7XG4gICAgY29uc3Qgc2VuZGVyID0ge1xuICAgICAgYWRkcmVzczogdHJhbnNhY3Rpb24uc2VuZGVyLFxuICAgICAgcHVibGljS2V5OiBzZW5kZXJQdWJsaWNLZXlcbiAgICB9O1xuICAgIGNvbnN0IG5ldHdvcmsgPSBjaGFpbklkVG9OZXR3b3JrKGFyZ3MudHJhbnNhY3Rpb24uY2hhaW5faWQuY2hhaW5JZCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXA6IE51bWJlcih0cmFuc2FjdGlvbi5leHBpcmF0aW9uX3RpbWVzdGFtcF9zZWNzKSxcbiAgICAgIGZlZVBheWVyLFxuICAgICAgZ2FzVW5pdFByaWNlOiBOdW1iZXIodHJhbnNhY3Rpb24uZ2FzX3VuaXRfcHJpY2UpLFxuICAgICAgbWF4R2FzQW1vdW50OiBOdW1iZXIodHJhbnNhY3Rpb24ubWF4X2dhc19hbW91bnQpLFxuICAgICAgbmV0d29yayxcbiAgICAgIHBheWxvYWQ6IHRyYW5zYWN0aW9uLnBheWxvYWQsXG4gICAgICBzZWNvbmRhcnlTaWduZXJzLFxuICAgICAgc2VuZGVyLFxuICAgICAgc2lnbmVyQWRkcmVzc1xuICAgIH07XG4gIH1cbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubm9ybWFsaXplQXJncyA9IG5vcm1hbGl6ZUFyZ3M7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUubmV0d29yayAhPT0gdm9pZCAwICYmICFpc1N1cHBvcnRlZE5ldHdvcmsodmFsdWUubmV0d29yaykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgbmV0d29yayAnJHt2YWx1ZS5uZXR3b3JrfSdgKTtcbiAgICB9XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLnNpZ25lckFkZHJlc3MgIT09IHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlLnNpZ25lckFkZHJlc3MgIT09IHZvaWQgMCkge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuc2lnbmVyQWRkcmVzcyk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplT3B0aW9uU3RyKHZhbHVlLm5ldHdvcmspO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZS5zZW5kZXIgIT09IHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlLnNlbmRlciAhPT0gdm9pZCAwKSB7XG4gICAgICBzZXJpYWxpemVBY2NvdW50SW5wdXQoc2VyaWFsaXplciwgdmFsdWUuc2VuZGVyKTtcbiAgICB9XG4gICAgaWYgKFwiYmNzVG9CeXRlc1wiIGluIHZhbHVlLnBheWxvYWQpIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh0cnVlKTtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLnBheWxvYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2woZmFsc2UpO1xuICAgICAgc2VyaWFsaXplVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQoc2VyaWFsaXplciwgdmFsdWUucGF5bG9hZCk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KHZhbHVlLmV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyA/PyAwKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVU2NCh2YWx1ZS5leHBpcmF0aW9uVGltZXN0YW1wID8/IDApO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KHZhbHVlLmdhc1VuaXRQcmljZSA/PyAwKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5tYXhHYXNBbW91bnQgPz8gMCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLmZlZVBheWVyICE9PSB2b2lkIDApO1xuICAgIGlmICh2YWx1ZS5mZWVQYXllciAhPT0gdm9pZCAwKSB7XG4gICAgICBzZXJpYWxpemVBY2NvdW50SW5wdXQoc2VyaWFsaXplciwgdmFsdWUuZmVlUGF5ZXIpO1xuICAgIH1cbiAgICBjb25zdCBzZWNvbmRhcnlTaWduZXJzID0gdmFsdWUuc2Vjb25kYXJ5U2lnbmVycyA/PyBbXTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChzZWNvbmRhcnlTaWduZXJzLmxlbmd0aCk7XG4gICAgZm9yIChjb25zdCBzaWduZXIgb2Ygc2Vjb25kYXJ5U2lnbmVycykge1xuICAgICAgc2VyaWFsaXplQWNjb3VudElucHV0KHNlcmlhbGl6ZXIsIHNpZ25lcik7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXJncyhkZXNlcmlhbGl6ZXIsIHZlcnNpb24pIHtcbiAgICBjb25zdCBoYXNTaWduZXJBZGRyZXNzID0gdmVyc2lvbiA+PSAzICYmIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCBzaWduZXJBZGRyZXNzID0gaGFzU2lnbmVyQWRkcmVzcyA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczgpIDogdm9pZCAwO1xuICAgIGNvbnN0IG5ldHdvcmsgPSB2ZXJzaW9uID09PSAxID8gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCkgOiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVPcHRpb25TdHIoKTtcbiAgICBpZiAobmV0d29yayAhPT0gdm9pZCAwICYmICFpc1N1cHBvcnRlZE5ldHdvcmsobmV0d29yaykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgbmV0d29yayAnJHtuZXR3b3JrfSdgKTtcbiAgICB9XG4gICAgY29uc3QgaGFzU2VuZGVyID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IHNlbmRlciA9IGhhc1NlbmRlciA/IGRlc2VyaWFsaXplQWNjb3VudElucHV0KGRlc2VyaWFsaXplcikgOiB2b2lkIDA7XG4gICAgY29uc3QgaXNQYXlsb2FkQmNzU2VyaWFsaXphYmxlID0gdmVyc2lvbiA8IDQgfHwgZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IHBheWxvYWQgPSBpc1BheWxvYWRCY3NTZXJpYWxpemFibGUgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoVHJhbnNhY3Rpb25QYXlsb2FkMikgOiBkZXNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0KGRlc2VyaWFsaXplcik7XG4gICAgY29uc3QgZXhwaXJhdGlvblNlY29uZHNGcm9tTm93ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgY29uc3QgZXhwaXJhdGlvblRpbWVzdGFtcCA9IE51bWJlcihkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVNjQoKSk7XG4gICAgY29uc3QgZ2FzVW5pdFByaWNlID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgY29uc3QgbWF4R2FzQW1vdW50ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgY29uc3QgaGFzRmVlUGF5ZXIgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gICAgY29uc3QgZmVlUGF5ZXIgPSBoYXNGZWVQYXllciA/IGRlc2VyaWFsaXplQWNjb3VudElucHV0KGRlc2VyaWFsaXplcikgOiB2b2lkIDA7XG4gICAgY29uc3Qgc2Vjb25kYXJ5U2lnbmVyc0xlbmd0aCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IHNlY29uZGFyeVNpZ25lcnMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlY29uZGFyeVNpZ25lcnNMZW5ndGg7IGkgKz0gMSkge1xuICAgICAgc2Vjb25kYXJ5U2lnbmVycy5wdXNoKGRlc2VyaWFsaXplQWNjb3VudElucHV0KGRlc2VyaWFsaXplcikpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgZXhwaXJhdGlvblNlY29uZHNGcm9tTm93OiBleHBpcmF0aW9uU2Vjb25kc0Zyb21Ob3cgPiAwID8gZXhwaXJhdGlvblNlY29uZHNGcm9tTm93IDogdm9pZCAwLFxuICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcDogZXhwaXJhdGlvblRpbWVzdGFtcCA+IDAgPyBleHBpcmF0aW9uVGltZXN0YW1wIDogdm9pZCAwLFxuICAgICAgZmVlUGF5ZXIsXG4gICAgICBnYXNVbml0UHJpY2U6IGdhc1VuaXRQcmljZSA+IDAgPyBnYXNVbml0UHJpY2UgOiB2b2lkIDAsXG4gICAgICBtYXhHYXNBbW91bnQ6IG1heEdhc0Ftb3VudCA+IDAgPyBtYXhHYXNBbW91bnQgOiB2b2lkIDAsXG4gICAgICBuZXR3b3JrLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIHNlY29uZGFyeVNpZ25lcnMsXG4gICAgICBzZW5kZXIsXG4gICAgICBzaWduZXJBZGRyZXNzXG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBzZXJpYWxpemUoZGFwcEluZm8sIGFyZ3MpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0geyBhcmdzLCBkYXBwSW5mbywgbmFtZTogU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubmFtZSwgdmVyc2lvbjogU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIuY3VycmVudFZlcnNpb24gfTtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKHJlcXVlc3QsIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlcXVlc3QpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MoXG4gICAgICBzZXJpYWxpemVkUmVxdWVzdCxcbiAgICAgIChkZXNlcmlhbGl6ZXIpID0+IGRlc2VyaWFsaXplQXJncyhkZXNlcmlhbGl6ZXIsIHNlcmlhbGl6ZWRSZXF1ZXN0LnZlcnNpb24pXG4gICAgKTtcbiAgfVxuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xuICBmdW5jdGlvbiBpc1NlcmlhbGl6ZWQocmVxdWVzdCkge1xuICAgIHJldHVybiByZXF1ZXN0Lm5hbWUgPT09IFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLm5hbWUgJiYgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIuc3VwcG9ydGVkVmVyc2lvbnMuaW5jbHVkZXMocmVxdWVzdC52ZXJzaW9uKTtcbiAgfVxuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5pc1NlcmlhbGl6ZWQgPSBpc1NlcmlhbGl6ZWQ7XG59KShTaWduVHJhbnNhY3Rpb25SZXF1ZXN0IHx8IChTaWduVHJhbnNhY3Rpb25SZXF1ZXN0ID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL3NpZ25UcmFuc2FjdGlvbi9yZXNwb25zZS50c1xuaW1wb3J0IHsgQWNjb3VudEF1dGhlbnRpY2F0b3IgYXMgQWNjb3VudEF1dGhlbnRpY2F0b3IyLCBSYXdUcmFuc2FjdGlvbiBhcyBSYXdUcmFuc2FjdGlvbjIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2U7XG4oKFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMikgPT4ge1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcHByb3ZhbEFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5hdXRoZW50aWNhdG9yKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUucmF3VHJhbnNhY3Rpb24gIT09IHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlLnJhd1RyYW5zYWN0aW9uICE9PSB2b2lkIDApIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLnJhd1RyYW5zYWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcHByb3ZhbEFyZ3MoZGVzZXJpYWxpemVyKSB7XG4gICAgY29uc3QgYXV0aGVudGljYXRvciA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QXV0aGVudGljYXRvcjIpO1xuICAgIGNvbnN0IGhhc1Jhd1RyYW5zYWN0aW9uID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IHJhd1RyYW5zYWN0aW9uID0gaGFzUmF3VHJhbnNhY3Rpb24gPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoUmF3VHJhbnNhY3Rpb24yKSA6IHZvaWQgMDtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aGVudGljYXRvcixcbiAgICAgIHJhd1RyYW5zYWN0aW9uXG4gICAgfTtcbiAgfVxuICBjb25zdCBzZXJpYWxpemVBcmdzID0gbWFrZVVzZXJSZXNwb25zZVNlcmlhbGl6ZUZuKHNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGNvbnN0IGRlc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VEZXNlcmlhbGl6ZUZuKGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MpIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoYXJncywgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2Uoc2VyaWFsaXplZFJlc3BvbnNlLCBkZXNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xufSkoU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UgfHwgKFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlID0ge30pKTtcblxuLy8gc3JjL21lc3NhZ2VzL2NvbW1vbi50c1xuZnVuY3Rpb24gaXNUeXBlZE1lc3NhZ2UobWVzc2FnZUNscywgbWVzc2FnZSkge1xuICByZXR1cm4gbWVzc2FnZT8uX19tZXNzYWdlVHlwZSA9PT0gbWVzc2FnZUNscy5UWVBFO1xufVxuXG4vLyBzcmMvbWVzc2FnZXMvYmFja2dyb3VuZC50c1xudmFyIF9BcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlID0gY2xhc3MgX0FwdG9zV2FsbGV0UmVxdWVzdE1lc3NhZ2Uge1xuICBjb25zdHJ1Y3Rvcihub25jZSwgc2VyaWFsaXplZFZhbHVlKSB7XG4gICAgdGhpcy5ub25jZSA9IG5vbmNlO1xuICAgIHRoaXMuc2VyaWFsaXplZFZhbHVlID0gc2VyaWFsaXplZFZhbHVlO1xuICAgIHRoaXMuX19tZXNzYWdlVHlwZSA9IF9BcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlLlRZUEU7XG4gIH1cbn07XG5fQXB0b3NXYWxsZXRSZXF1ZXN0TWVzc2FnZS5UWVBFID0gXCJBcHRvc1dhbGxldFJlcXVlc3RcIjtcbnZhciBBcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlID0gX0FwdG9zV2FsbGV0UmVxdWVzdE1lc3NhZ2U7XG52YXIgX0FwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZSA9IGNsYXNzIF9BcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2Uge1xuICBjb25zdHJ1Y3RvcihzZXJpYWxpemVkVmFsdWUsIG5vbmNlKSB7XG4gICAgdGhpcy5zZXJpYWxpemVkVmFsdWUgPSBzZXJpYWxpemVkVmFsdWU7XG4gICAgdGhpcy5ub25jZSA9IG5vbmNlO1xuICAgIHRoaXMuX19tZXNzYWdlVHlwZSA9IF9BcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9BcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2UuVFlQRSA9IFwiQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlXCI7XG52YXIgQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlID0gX0FwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZTtcbnZhciBfQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZSA9IGNsYXNzIF9BcHRvc1dhbGxldEVycm9yUmVzcG9uc2VNZXNzYWdlIHtcbiAgY29uc3RydWN0b3IoZXJyb3IsIG5vbmNlKSB7XG4gICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgIHRoaXMubm9uY2UgPSBub25jZTtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZS5UWVBFO1xuICB9XG59O1xuX0FwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2UuVFlQRSA9IFwiQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZVwiO1xudmFyIEFwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2UgPSBfQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZTtcbmZ1bmN0aW9uIGlzQXB0b3NXYWxsZXRSZXNwb25zZU1lc3NhZ2UobWVzc2FnZSkge1xuICByZXR1cm4gaXNUeXBlZE1lc3NhZ2UoQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlLCBtZXNzYWdlKSB8fCBpc1R5cGVkTWVzc2FnZShBcHRvc1dhbGxldEVycm9yUmVzcG9uc2VNZXNzYWdlLCBtZXNzYWdlKTtcbn1cblxuLy8gc3JjL21lc3NhZ2VzL3Byb21wdC50c1xuaW1wb3J0IHsgRGVzZXJpYWxpemVyIGFzIERlc2VyaWFsaXplcjE2LCBTZXJpYWxpemVyIGFzIFNlcmlhbGl6ZXIxNiB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBfUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlID0gY2xhc3MgX1Byb21wdE9wZW5lclBpbmdSZXF1ZXN0TWVzc2FnZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuX19tZXNzYWdlVHlwZSA9IF9Qcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9Qcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2UuVFlQRSA9IFwiUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RcIjtcbnZhciBQcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2UgPSBfUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlO1xudmFyIF9Qcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlID0gY2xhc3MgX1Byb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlTWVzc2FnZS5UWVBFO1xuICB9XG59O1xuX1Byb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2UuVFlQRSA9IFwiUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlXCI7XG52YXIgUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlTWVzc2FnZSA9IF9Qcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlO1xudmFyIF9Qcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZSA9IGNsYXNzIF9Qcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZSB7XG4gIGNvbnN0cnVjdG9yKHNlcmlhbGl6ZWRWYWx1ZSkge1xuICAgIHRoaXMuc2VyaWFsaXplZFZhbHVlID0gc2VyaWFsaXplZFZhbHVlO1xuICAgIHRoaXMuX19tZXNzYWdlVHlwZSA9IF9Qcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZS5UWVBFO1xuICB9XG59O1xuX1Byb21wdEFwcHJvdmFsUmVzcG9uc2VNZXNzYWdlLlRZUEUgPSBcIlByb21wdEFwcHJvdmFsUmVzcG9uc2VcIjtcbnZhciBQcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZSA9IF9Qcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZTtcbnZhciBfUHJvbXB0VW5hdXRob3JpemVkRXJyb3JNZXNzYWdlID0gY2xhc3MgX1Byb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuX19tZXNzYWdlVHlwZSA9IF9Qcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9Qcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2UuVFlQRSA9IFwiUHJvbXB0VW5hdXRob3JpemVkRXJyb3JcIjtcbnZhciBQcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2UgPSBfUHJvbXB0VW5hdXRob3JpemVkRXJyb3JNZXNzYWdlO1xuZnVuY3Rpb24gdXJsRW5jb2RlV2FsbGV0UmVxdWVzdChyZXF1ZXN0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcjE2KCk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHJlcXVlc3QubmFtZSk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplQnl0ZXMocmVxdWVzdC5kYXRhKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIocmVxdWVzdC52ZXJzaW9uLnRvU3RyaW5nKCkpO1xuICByZXR1cm4gYnl0ZXNUb0Jhc2U2NChzZXJpYWxpemVyLnRvVWludDhBcnJheSgpKTtcbn1cbmZ1bmN0aW9uIHVybERlY29kZVdhbGxldFJlcXVlc3QoZW5jb2RlZFJlcXVlc3QpIHtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcjE2KGJhc2U2NFRvQnl0ZXMoZW5jb2RlZFJlcXVlc3QpKTtcbiAgY29uc3QgbmFtZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpO1xuICBjb25zdCBkYXRhID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQnl0ZXMoKTtcbiAgbGV0IHZlcnNpb247XG4gIHRyeSB7XG4gICAgdmVyc2lvbiA9IE51bWJlcihkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKSk7XG4gIH0gY2F0Y2gge1xuICAgIHZlcnNpb24gPSAxO1xuICB9XG4gIHJldHVybiB7IGRhdGEsIG5hbWUsIHZlcnNpb24gfTtcbn1cblxuLy8gc3JjL1BvcHVwV2FsbGV0UmVxdWVzdC50c1xuaW1wb3J0IHtcbiAgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3M5LFxuICBFZDI1NTE5UHVibGljS2V5IGFzIEVkMjU1MTlQdWJsaWNLZXkyLFxuICBFZDI1NTE5U2lnbmF0dXJlIGFzIEVkMjU1MTlTaWduYXR1cmUyLFxuICBTZXJpYWxpemVyIGFzIFNlcmlhbGl6ZXIxN1xufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5cbi8vIHNyYy9XYWxsZXRSZXF1ZXN0Qm9keS50c1xuZnVuY3Rpb24gZW5jb2RlV2FsbGV0UmVxdWVzdEJvZHkoeyBkYXRhLCAuLi5yZXN0IH0pIHtcbiAgY29uc3Qgc2VyaWFsaXplZCA9IEpTT04uc3RyaW5naWZ5KHsgZGF0YSwgLi4ucmVzdCB9LCAoa2V5LCB2YWx1ZSkgPT4ga2V5ID09PSBcImRhdGFcIiA/IGJ5dGVzVG9CYXNlNjQodmFsdWUpIDogdmFsdWUpO1xuICBjb25zdCB1dGY4RW5jb2RlZCA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzZXJpYWxpemVkKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQodXRmOEVuY29kZWQpO1xufVxuZnVuY3Rpb24gZGVjb2RlV2FsbGV0UmVxdWVzdEJvZHkoZW5jb2RlZCkge1xuICBjb25zdCB1dGZFbmNvZGVkID0gYmFzZTY0VG9CeXRlcyhlbmNvZGVkKTtcbiAgY29uc3Qgc2VyaWFsaXplZCA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZSh1dGZFbmNvZGVkKTtcbiAgcmV0dXJuIEpTT04ucGFyc2Uoc2VyaWFsaXplZCwgKGtleSwgdmFsdWUpID0+IGtleSA9PT0gXCJkYXRhXCIgPyBiYXNlNjRUb0J5dGVzKHZhbHVlKSA6IHZhbHVlKTtcbn1cblxuLy8gc3JjL1BvcHVwV2FsbGV0UmVxdWVzdC50c1xuZnVuY3Rpb24gZW5jb2RlUG9wdXBXYWxsZXRSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgY29uc3Qgc2VyaWFsaXplZCA9IEpTT04uc3RyaW5naWZ5KHJlcXVlc3QsIChrZXksIHZhbHVlKSA9PiB7XG4gICAgc3dpdGNoIChrZXkpIHtcbiAgICAgIGNhc2UgXCJib2R5XCI6XG4gICAgICAgIHJldHVybiBlbmNvZGVXYWxsZXRSZXF1ZXN0Qm9keSh2YWx1ZSk7XG4gICAgICBjYXNlIFwiY2xpZW50SWRlbnRpdHlLZXlcIjpcbiAgICAgICAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQodmFsdWUudG9VaW50OEFycmF5KCkpO1xuICAgICAgY2FzZSBcInNpZ25hdHVyZVwiOlxuICAgICAgICByZXR1cm4gYnl0ZXNUb0Jhc2U2NCh2YWx1ZS50b1VpbnQ4QXJyYXkoKSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgdXRmOEVuY29kZWQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VyaWFsaXplZCk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0dXJsKHV0ZjhFbmNvZGVkKTtcbn1cbmZ1bmN0aW9uIGRlY29kZVBvcHVwV2FsbGV0UmVxdWVzdChlbmNvZGVkKSB7XG4gIGNvbnN0IHV0ZkVuY29kZWQgPSBiYXNlNjR1cmxUb0J5dGVzKGVuY29kZWQpO1xuICBjb25zdCBzZXJpYWxpemVkID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHV0ZkVuY29kZWQpO1xuICByZXR1cm4gSlNPTi5wYXJzZShzZXJpYWxpemVkLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlIFwiYm9keVwiOlxuICAgICAgICByZXR1cm4gZGVjb2RlV2FsbGV0UmVxdWVzdEJvZHkodmFsdWUpO1xuICAgICAgY2FzZSBcImNsaWVudElkZW50aXR5S2V5XCI6XG4gICAgICAgIHJldHVybiBuZXcgRWQyNTUxOVB1YmxpY0tleTIoYmFzZTY0VG9CeXRlcyh2YWx1ZSkpO1xuICAgICAgY2FzZSBcInNpZ25hdHVyZVwiOlxuICAgICAgICByZXR1cm4gbmV3IEVkMjU1MTlTaWduYXR1cmUyKGJhc2U2NFRvQnl0ZXModmFsdWUpKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gbWFrZVBvcHVwV2FsbGV0UmVxdWVzdENoYWxsZW5nZSh7XG4gIGFjY291bnRBZGRyZXNzLFxuICBib2R5LFxuICBpZCxcbiAgdGltZXN0YW1wXG59KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcjE3KCk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKFwiU2lnbmVkUG9wdXBXYWxsZXRSZXF1ZXN0XCIpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cihpZCk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTY0KHRpbWVzdGFtcCk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbChhY2NvdW50QWRkcmVzcyAhPT0gdm9pZCAwKTtcbiAgaWYgKGFjY291bnRBZGRyZXNzICE9PSB2b2lkIDApIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczkuZnJvbShhY2NvdW50QWRkcmVzcykpO1xuICB9XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKGJvZHkubmFtZSk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTgoYm9keS52ZXJzaW9uKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVCeXRlcyhib2R5LmRhdGEpO1xuICByZXR1cm4gc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKTtcbn1cbmV4cG9ydCB7XG4gIEFwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2UsXG4gIEFwdG9zV2FsbGV0UmVxdWVzdE1lc3NhZ2UsXG4gIEFwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZSxcbiAgQ29ubmVjdFJlcXVlc3QsXG4gIENvbm5lY3RSZXNwb25zZSxcbiAgRGlzY29ubmVjdFJlcXVlc3QsXG4gIERpc2Nvbm5lY3RSZXNwb25zZSxcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudCxcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0LFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlLFxuICBJc0Nvbm5lY3RlZFJlcXVlc3QsXG4gIElzQ29ubmVjdGVkUmVzcG9uc2UsXG4gIFByb21wdEFwcHJvdmFsUmVzcG9uc2VNZXNzYWdlLFxuICBQcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2UsXG4gIFByb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2UsXG4gIFByb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZSxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UsXG4gIFNpZ25NZXNzYWdlUmVxdWVzdCxcbiAgU2lnbk1lc3NhZ2VSZXNwb25zZSxcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UsXG4gIFRyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudCxcbiAgYmFzZTY0VG9CeXRlcyxcbiAgYmFzZTY0dXJsVG9CeXRlcyxcbiAgYnl0ZXNUb0Jhc2U2NCxcbiAgYnl0ZXNUb0Jhc2U2NHVybCxcbiAgY2hhaW5JZFRvTmV0d29yayxcbiAgZGVjb2RlUG9wdXBXYWxsZXRSZXF1ZXN0LFxuICBkZWNvZGVXYWxsZXRSZXF1ZXN0Qm9keSxcbiAgZGVzZXJpYWxpemVBY2NvdW50QXV0aGVudGljYXRvcklucHV0LFxuICBkZXNlcmlhbGl6ZUFjY291bnRJbmZvLFxuICBkZXNlcmlhbGl6ZUFjY291bnRJbnB1dCxcbiAgZGVzZXJpYWxpemVEYXBwSW5mbyxcbiAgZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQsXG4gIGRlc2VyaWFsaXplUHVibGljS2V5LFxuICBkZXNlcmlhbGl6ZVNpZ25hdHVyZSxcbiAgZGVzZXJpYWxpemVUcmFuc2FjdGlvblBheWxvYWRJbnB1dCxcbiAgZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0LFxuICBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyxcbiAgZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZSxcbiAgZW5jb2RlUG9wdXBXYWxsZXRSZXF1ZXN0LFxuICBlbmNvZGVXYWxsZXRSZXF1ZXN0Qm9keSxcbiAgaXNBcHRvc1dhbGxldFJlc3BvbnNlTWVzc2FnZSxcbiAgaXNTdXBwb3J0ZWROZXR3b3JrLFxuICBpc1R5cGVkTWVzc2FnZSxcbiAgbWFrZVBvcHVwV2FsbGV0UmVxdWVzdENoYWxsZW5nZSxcbiAgbWFrZVVzZXJBcHByb3ZhbCxcbiAgbWFrZVVzZXJSZXNwb25zZURlc2VyaWFsaXplRm4sXG4gIG1ha2VVc2VyUmVzcG9uc2VTZXJpYWxpemVGbixcbiAgc2VyaWFsaXplQWNjb3VudEF1dGhlbnRpY2F0b3JJbnB1dCxcbiAgc2VyaWFsaXplQWNjb3VudEluZm8sXG4gIHNlcmlhbGl6ZUFjY291bnRJbnB1dCxcbiAgc2VyaWFsaXplRGFwcEluZm8sXG4gIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudCxcbiAgc2VyaWFsaXplUHVibGljS2V5LFxuICBzZXJpYWxpemVTaWduYXR1cmUsXG4gIHNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0LFxuICBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0LFxuICBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MsXG4gIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlLFxuICB1cmxEZWNvZGVXYWxsZXRSZXF1ZXN0LFxuICB1cmxFbmNvZGVXYWxsZXRSZXF1ZXN0XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@aptos-connect+wallet-api@0.1.5_@aptos-labs+ts-sdk@1.30.0_@aptos-labs+wallet-standard@0.2.0_aptos@1.21.0/node_modules/@aptos-connect/wallet-api/dist/index.mjs\n");

/***/ })

};
;